<HTML>
<HEAD>
<TITLE>  Facturacion Polar</TITLE>
<!-- <link rel="stylesheet" href="styles.css" > -->
<link rel="manifest" href="manifest.json"> 

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
<style>

body{
font-size:30px;
}
input[type=number]{
width: 3em;
}


.btop{
font-size:1em;
}

.bot3:hover {
  background-color: #4CAF50; /* Green */
  color: blue;
}
.bot3{
transition-duration: 0.4s;
background-color: #4CAF50; /* Green */
padding:15px;
font-size:1.5em;
width:70%;
}

.bot4:hover {
  background-color: #4CAF50; /* Green */
  color: white;
}
.bot4{
background-color: #4CAF50; /* Green */
transition-duration: 0.4s;
padding:15px;
font-size:1.0em;
width:70%;
}
.btn2{
font-size:1em;
}


#dsearch {
position:relative;
}

#enc {
position:relative;
}
.nav {
font-size:2em;

}
#divt {
top:35%;
left:0%;
height: 60%;
text-align:center;
width:95%;
overflow-y:auto;
}

input[type=text]{
font-size:0.8em;
width: 4em;
border: 2px solid red;
border-radius: 4px;
padding: 4px 4px;
  margin: 4px 0;
  box-sizing: border-box;
  background-color: #3CBC8D;
  color: white;
}

input[type=text]:focus {
  background-color: lightblue;
}

p{
font-size:1.5rem;
background-color:black;
color:white;
padding:0px;
margin:0px;

}
td{
font-size:1.5rem;
padding:1px;
}
table{
margin:0px;
padding:0px;

}

#cat {
position:fixed;
top:35%;
left:0px;
height: 60%;
font-size:1.5rem;
text-align:center;
width:95%;
overflow-y:scroll;
}

#introd {
position:fixed;
background-color:green;
top:30%;
left:0%;
height: 40%;
width:98%;
overflow-y:scroll;
}

#footer {
  display: none;
  position: fixed;
  left: 0;
  bottom: 0;
  width: 100%;
  background-color: blue;
  color: white;
  text-align: center;
  font-size:0.5em;
}

#header {
  position: fixed;
  left: 0;
  top: 0;
  height=5%;
  width: 100%;
  background-color: blue;
  color: white;
  text-align: center;
  font-size:0.5em;
}

#cliente {
  position: fixed;
  left: 0;
  top: 5%;
  height=10%;
   width: 100%;
  background-color: black;
  color: red;
  text-align: left;
  font-size:0.8em;
}

.dolar {
 // position: fixed;
 // left: 0;
 // top: 50px;
  width: 100%;
  }
.cont0{
}
.cont1 {
display:grid;
grid-template-columns: 20% 60% 20%;
border-bottom:1px solid black;
}

.conth1 {
grid-columns: 1/2;
}
.conth2 {
grid-columns: 2/3;
}
.conth3 {
grid-columns: 3/4;
}


</style>

</HEAD>


<BODY onload="carga();" onunload="salir();">

<br>

<div class="dolar">
<!-- <table width="100%"> -->
<!-- <tr><td>Paralelo </td><td><input id="t1" type="text" value="0"></td> -->
<!-- <tr><td>BCV </td><td><input id="t2" type="text" value="0"></td></tr> -->
<!-- <div id="menu"></div> -->
<!-- <tr><td><input id="t3" onchange="camb();" type="checkbox" value="Automatico"><label for="t3"> Automatico </label></td></tr> -->
<!-- </table> -->
</div>
<div class="cont0">
<div class="cont1">
<div class="con1h1">
<center>BCV: <input id="t2" type="text" value="0"></center>
</div>
<div class="con1h2">
<center>Facturaci&oacute;n <br><span id="fecha_p" style="font-size:0.8em;"></span></center>
</div>
<div class="con1h3">
<button class="nav" onclick="sube_cat()";>&#8630;</button>
</div>
</div>
</div>
<div id="arbol"></div>
<div id="cat" ></div>
<!-- <div id="dsearch"> <input id="search" type="text" placeholder="Buscar" oninput="refresca();"></div>-->
<div id="divt" ></div>
<div id="introd" ></div>
<div id="content" hidden="false"></div>
<div id="factura" hidden="true">

</div>
 <div id="footer"> Dr. Braulio De Abreu. email: brauliodeabreu@gmail.com <br> Tlfs: +58414 4728631 +58412 8552592</div>
 <div id="header">
<table width="100%">
<tr align="center">
<td width="12%"> <button class="btop" onclick="Actualiza_cliente();">C</button></td>
<td width="12%"><button class="btop" onclick="descarga_historico();">A</button></td>
<td width="12%"><button class="btop" onclick="factura();">F</button></td> 
<td width="12%"><button class="btop" onclick="anula();">Z</button></td>
<td width="12%"><button class="btop" onclick="guardar_factura();">G</button></td>
<td width="12%"><button class="btop" onclick="lee_facturas();">R</button></td>
<td width="12%"><button class="btop" onclick="total();">T</button></td>
<td width="12%"><button class="btop" onclick="desp_inventario();">I</button></td>

</tr></table>
</div>
<div id="cliente" hidden="true">
<span onclick="limpiaCliente();">Cliente:</span> <input style="width:55%;" type="text" id="cli" value="" list="listaclientes">&nbsp&nbsp<button onclick="setcliente();">OK</button>&nbsp&nbsp<button onclick="elimina_cliente();">E</button>'
<datalist id="listaclientes"></datalist>
</div>

<div id="lista" > </div>
<!--   -->

<script src="arbol.js" type="text/javascript"></script>
<script type="text/javascript">
function leer_ventas_diarias(fecha){
//=localStorage,getItem(fecha)

}
var totalunid=[];
var totalcajas=[];
var modo_inv=false;
function muestra_total_ventas(){
var nd=data.length;
var texto='';
var div3 = document.getElementById("lista");
div3.style="position: fixed;top :7%; left: 0px; width: 100%;height:80%;background-color:lightgray;color:white; text-align: left; border: 3px solid #73AD21;";
texto+='<div style="position: fixed; text-align:right;background-color: gray;width:100%;">';
texto+=' <button  title="Salir" onclick="quitarlista();" > x </button></div><br>';
texto+='<div style="overflow:auto;height:90%;font-size:0.8rem;"><table style="width:100%;">';
for(var i=0;i<nd;i++){
 if (totalcajas[i]!=0) {
console.log(data[i][0]+" "+totalcajas[i]+ " cajas");
texto+='<tr><td style="width:80%;">'+data[i][0]+'</td><td style="width:15%;">'+totalcajas[i]+'<td style="width:5%;">C</td>'+'</td></tr>';
}
 if (totalunid[i]!=0) {
console.log(data[i][0]+" "+totalunid[i]+" unidades");
texto+='<tr><td style="width:80%;">'+data[i][0]+'</td><td style="width:15%;">'+totalunid[i]+'<td style="width:5%;">U</td>'+'</td></tr>';
}

}
texto+='</table></div>';
div3.innerHTML=texto;
}

function fecha_mayor_igual(f1,f2){
var a2=f2.split('/');
var a1=f1.split('/');
 if (a2[2]>a1[2] || (a2[2]==a1[2] && a2[1]>a1[1]) || (a2[2]==a1[2] && a2[1]==a1[1]) && a2[0]>a1[0]) {return false; } else {return true;}
}

function inv_fecha_date(f){
var comp=f.split('-');
var sal=comp[2]+'/'+comp[1]+'/'+comp[0];
//console.log('sal2 '+sal);
return sal;
}

function fecha_date(f){
var comp=f.split('/');
var sal=comp[2]+'-'+comp[1]+'-'+comp[0];
console.log('sal '+sal)
return sal;
}

function fecha_estandar(f){
  var year=f.getFullYear();
  var mes=f.getMonth();mes++;if (mes<10) {mes='0'+mes}
  var day=f.getDate();if (day<10) {day='0'+day}
return day+'/'+mes+'/'+year;
}
function total(){
var textoT="";
var div3 = document.getElementById("lista");
div3.style="position: fixed;top :0px; left: 0px; width: 100%;height:40%;background-color: black;color:white; text-align: left; border: 3px solid #73AD21;";

textoT+='Desde: <input id="f1" type="date" value="'+fecha_date(fecha_actual())+'"><br>';
textoT+='Hasta: <input id="f2" type="date" value="'+fecha_date(fecha_actual())+'"><br><br>';

textoT+='<button onclick="quitarlista();" >Cancelar </button>&nbsp&nbsp&nbsp<button onclick="total_unidades_vendidas();" >Ok </button>';
div3.innerHTML=textoT;

}

function total_unidades_vendidas(){
var f1=document.getElementById("f1").value;
var f2=document.getElementById("f2").value;
f1=inv_fecha_date(f1);
f2=inv_fecha_date(f2);
quitarlista();
console.log('rango de fechas'+f1+' '+f2);

var nd=data.length;
console.log(nd);
for(var i=0;i<nd;i++){
 totalunid[i]=0;
 totalcajas[i]=0;
}
var fecha=fecha_actual();
console.log(fecha);
for(var i=0;i<localStorage.length;i++){
 var nomb=localStorage.key(i); 
 if (nomb.indexOf("FAC_")==0 )  
{ 
  var fech=nomb.split('_')[2];
  var nombcli=nomb.split('_')[1];
  console.log('nc'+nombcli);

  texto=localStorage.getItem(nomb);
  
console.log('fech'+fech);
if ((texto!='') && (fecha_mayor_igual(fech,f1)) && (fecha_mayor_igual(f2,fech)) && nombcli!="POLAR") {
    var ped=texto.split('&');
    console.log(texto+" "+texto.length);
    //console.log(ped.length);
    for (var j=1;j<ped.length;j++) {
      var items=ped[j].split('#');
      var ind=clave_ind.get(items[0]);
      totalunid[ind]+=parseInt(items[1]);
      totalcajas[ind]+=parseInt(items[3]);
    }
 
  } 
 } 
}
 muestra_total_ventas();
}
inventario=[];

function carga_inventario(){
var invent=localStorage.getItem('Inventario_PO');
if (invent!=null) {
 var items=invent.split('&');
  for (var i=0;i<items.length;i++){
   console.log(items[i]);
   var partes=items[i].split('#');
    ind=inventario.findIndex(element => element.CLAVE==partes[0])
   inventario[ind]={"CLAVE":partes[0],"UNID":partes[1],"CAJAS":partes[2]};
  }
}
console.log(inventario);
}
function desp_inventario(){
texto='';
carga_inventario();
var div3 = document.getElementById("lista");
div3.style="position: fixed;top :7%; left: 0%; width: 100%;height:80%;background-color:lightgray;color:white; text-align: left; border: 3px solid #73AD21;";
texto+='<div style="position: fixed;top :7%; text-align:right;background-color: gray;width:100%;">';
texto+=' <button  title="Salir" onclick="quitarlista();" > x </button></div><br>';
texto+='<div style="overflow:auto;height:90%;font-size:0.8rem;"><table style="width:100%;">';
 console.log(inventario);
for(var i=0;i<inventario.length;i++){
console.log('clave '+inventario[i]["CLAVE"]);
 var ind=clave_ind.get(inventario[i]["CLAVE"]);
 console.log('indice '+ind);
 if (inventario[i]["UNID"]!=0) {
console.log(data[ind][0]+inventario[i]["UNID"]+ " cajas");
texto+='<tr><td style="width:80%;">'+data[ind][0]+'</td><td style="width:15%;">'+inventario[i]["UNID"]+'<td style="width:5%;">U</td>'+'</td></tr>';
}
 if (inventario[i]["CAJAS"]!=0) {
console.log(data[ind][0]+" "+inventario[i]["CAJAS"]+" unidades");
texto+='<tr><td style="width:80%;">'+data[ind][0]+'</td><td style="width:15%;">'+inventario[i]["CAJAS"]+'<td style="width:5%;">C</td>'+'</td></tr>';
}

}
texto+='</table></div>';
div3.innerHTML=texto;
}


function guarda_inventario(){
var texto="";
  for (var i=0;i<inventario.length;i++){
      texto+='&'+inventario[i]["CLAVE"]+'#'+inventario[i]["UNID"]+'#'+inventario[i]["CAJAS"];
  }
if (texto.length>0) {localStorage.setItem('Inventario_PO',texto.substr(1));} else {localStorage.setItem('Inventario_PO','');}
}

function resta_inventario(){
  for (var i=0;i<data.length;i++){
      if (data[i][4]!=0 || data[i][5]!=0) {
       ind=inventario.findIndex(element => element.CLAVE==data[i][9])
       inventario[ind]["UNID"]=(parseInt(inventario[ind]["UNID"])-data[i][4]).toString();
       inventario[ind]["CAJAS"]=(parseInt(inventario[ind]["CAJAS"])-data[i][5]).toString();
         if (inventario[ind]["UNID"]<0) {
           var cj=1+Math.abs(parseInt(inventario[ind]["UNID"])/parseInt(data[i][1]));
           cj=parseInt(cj);
           inventario[ind]["UNID"]=(parseInt(inventario[ind]["UNID"])+cj*parseInt(data[i][1])).toString();
           inventario[ind]["CAJAS"]=(parseInt(inventario[ind]["CAJAS"])-cj).toString();
         }
       }
 }
guarda_inventario();
}

function inicio_inventario(){
 for (var i=0;i<data.length;i++){
    inventario[i]={"CLAVE":data[i][9],"UNID":"0","CAJAS":"0"}
}
console.log(inventario);
carga_inventario();

console.log(inventario);
}

function suma_inventario(){
  for (var i=0;i<data.length;i++){
      if (data[i][4]!=0 || data[i][5]!=0) {
       ind=inventario.findIndex(element => element.CLAVE==data[i][9])
    console.log('ind '+ind);
       inventario[ind]["UNID"]=(parseInt(inventario[ind]["UNID"])+parseInt(data[i][4])).toString();
       inventario[ind]["CAJAS"]=(parseInt(inventario[ind]["CAJAS"])+parseInt(data[i][5])).toString();
      }
 }
console.log(inventario);
guarda_inventario();
}

function ventas_periodo(fecha1,fecha2){
}

var cliente='';
var AClientes=[];
function limpiaCliente(){
document.getElementById("cli").value='';
}
function elimina_cliente(){
var ecliente;
document.getElementById("cliente").hidden=true;
ecliente=document.getElementById("cli").value;
var pos=AClientes.indexOf(ecliente);
if (pos>=0) {AClientes.splice(pos,1);guarda_clientes();}


//console.log('LC: '+Lclientes);
}


function setcliente(){
document.getElementById("cliente").hidden=true;
cliente=document.getElementById("cli").value;
if (document.getElementById("factura").hidden==false) {factura2();}
//console.log('LC: '+Lclientes);
//console.log('C: '+cliente);
//console.log('Lo: '+AClientes.length);
//console.log(AClientes.indexOf(cliente));
if (AClientes.indexOf(cliente)==-1) {AClientes.push(cliente);guarda_clientes();}
//console.log('LC: '+Lclientes);
}


function Actualiza_cliente(){
Lee_clientes();
divcliente=document.getElementById("cliente");
document.getElementById("cli").value=cliente;
//divcliente.innerHTML=texto;
divcliente.hidden=false;

}


function guarda_clientes(){
var Lclientes='';
for (var i = 0; i < AClientes.length; i++){
Lclientes+='&'+AClientes[i];
}
//console.log('LC: '+Lclientes);
if (Lclientes.length>0) {localStorage.setItem('Clientes',Lclientes.substr(1));}
   else 
{localStorage.setItem('Clientes','');}

}


function Lee_clientes(){
Lclientes=localStorage.getItem('Clientes');
if (Lclientes!='' && Lclientes!=null) {
AClientes=Lclientes.split('&');
var options='';
for (var i = 0; i < AClientes.length; i++) {
  options += '<option value="' + AClientes[i] + '" />';
}

//console.log('op'+options)
document.getElementById('listaclientes').innerHTML = options;
}
}

function guarda_pedido(){
var texto='';
for (var i=0;i<data.length;i++) {
if ((data[i][4]!=0) || (data[i][5]!=0)) { 
 texto+='&'+data[i][9]+'#'+data[i][4]+'#'+data[i][5];
}
if (texto.length>2) {localStorage.setItem('Pedido',texto.substr(1));} else {localStorage.setItem('Pedido','');}
} 
localStorage.setItem('Cliente',cliente);
}


function lee_facturas(){
listasel=[];
console.log("paso");
for(var i=0;i<localStorage.length;i++){
var nomb=localStorage.key(i); 
if (nomb.indexOf("FAC_")==0) {listasel.unshift(nomb.substr(4));} 
 } 
selectlista();
}

function selectlista(){
var textoT="";
var div3 = document.getElementById("lista");
div3.style="position: fixed;top :0px; left: 0px; width: 100%;height:80%;background-color: lightgray;color:white; text-align: left; border: 3px solid #73AD21;";
textoT+='<div style="position: fixed; text-align:right;background-color: gray;width:100%;">';
textoT+=' <button  title="Salir" onclick="quitarlista();" > x </button></div><br>';
textoT+='<div style="overflow:auto;height:90%;font-size:0.8rem;">';
textoT+='<table width="100%">';
for (var i=0;i<listasel.length;i++) {
textoT+='<tr><td style="width:85%;color:white;background:black;border:2px solid #FFFFFF;cursor:pointer;" onclick="clickp('+i+')";>'+listasel[i]+'</td><td style="width:15%;"><button onclick="borra('+i+')";>E</button></td></tr>'; 
}
textoT+='</table></div>';
div3.innerHTML=textoT;
}
function quitarlista(){
var div3 = document.getElementById("lista");
div3.style="display: none;";
}
function borra(num){
var nomb="FAC_"+listasel[num];
var resp=prompt("Esta seguro de eliminar la factura",'S/N'); 
if (resp=='S' || resp=='s' ) {localStorage.removeItem(nomb);}
quitarlista();
lee_facturas();
}

function clickp(num){
var nomb=listasel[num];
recupera_factura("FAC_"+nomb);
for (var i=0;i<datfac.length;i++) {
if ((datfac[i].unidad!=0) || (datfac[i].cajas!=0)) {
 console.log(datfac[i].unidad+" "+datfac[i].pu+" "+datfac[i].cajas+" "+datfac[i].pb);
}
} 
factura3();
quitarlista();
}
function guardar_factura(){
//nro_factura=1;
var resp=prompt("Cliente: "+cliente+"Introduzca el numero de la factura:",nro_factura)
if (resp!='') {nro_factura=parseInt(resp);guarda_factura(); localStorage.setItem('FACT_NRO',(nro_factura+1).toString())}
}


function guarda_factura(){
var pu,pb;
var bcv=parseFloat(document.getElementById("t2").value);
var texto=(bcv).toFixed(2);
var nomb='FAC'+'_'+cliente+'_'+fecha_actual()+'_'+nro_factura;
console.log('nomb '+nomb);
for (var i=0;i<data.length;i++) {
if ((data[i][4]!=0) || (data[i][5]!=0)) { 
 [pu,pb]=precio(i);
console.log('pu '+pu+'pb '+pb);
 texto+='&'+data[i][9]+'#'+data[i][4]+'#'+(pu).toFixed(2)+'#'+data[i][5]+'#'+(pb).toFixed(2);
}
}
if (texto.length>2) {localStorage.setItem(nomb,texto);} 
if (cliente=='POLAR') {suma_inventario();} else {resta_inventario();}
}


function recupera_pedido(archivo){
var texto;
cliente=localStorage.getItem('Cliente');
document.getElementById("cli").value=cliente;
for (var i=0;i<data.length;i++) {
data[i][4]=0;
data[i][5]=0; 
}

texto=localStorage.getItem(archivo);
if (texto!='') {
var ped=texto.split('&');
//console.log('texto: '+texto.length);
//console.log(ped.length);
for (var i=0;i<ped.length;i++) {
  var items=ped[i].split('#');
  var ind=clave_ind.get(items[0]);
  data[ind][4]=parseInt(items[1]);
  data[ind][5]=parseInt(items[2]);
}
}

}

var datfac=[];
function recupera_factura(archivo){
var texto;

cliente=localStorage.getItem('Cliente');
document.getElementById("cli").value=cliente;
for (var i=0;i<data.length;i++) {
datfac[i]=new Object();
datfac[i].unidad=0;
datfac[i].pu=0;
datfac[i].cajas=0;
datfac[i].pb=0;

}

texto=localStorage.getItem(archivo);

if (texto!='') {
var ped=texto.split('&');
bcv_factura=ped[0];
fecha_factura=archivo.split('_')[2];
cliente_factura=archivo.split('_')[1];
numero_factura=archivo.split('_')[3];
//console.log('texto: '+texto.length);
//console.log(ped.length);
for (var i=1;i<ped.length;i++) {
  var items=ped[i].split('#');
//  var ind=parseInt(items[0]);
 var ind=clave_ind.get(items[0]);
console.log('ind'+ind);
  datfac[ind].unidad=parseInt(items[1]);
  datfac[ind].pu=parseFloat(items[2]);
  datfac[ind].cajas=parseInt(items[3]);
  datfac[ind].pb=parseFloat(items[4]);
}
}

}
function salir(){
guarda_pedido();
//t1=document.getElementById("t1").value;
t2=document.getElementById("t2").value;
//localStorage.setItem('p1',t1);
localStorage.setItem('p2',t2);
}
var lcat=[];
var Stack_cat=['Tienda'];
var Cats;
var cat_actual='Tienda';
var cat_ant='';

function set_cat(){
Cats = new Tree();
Cats.add('Tienda','');
var categorias=[];
var ldatos=data.length;
for (i=0;i<ldatos;i++){
//console.log(data[i][8]);
 if (data[i][8]==1) {
  if  (!categorias.includes(data[i][7])) {
     categorias.push(data[i][7]);   
  } 
 }
}
var categ;
var nrocateg;
var ldatos2=categorias.length;
//console.log(ldatos2);
for (i=0;i<ldatos2;i++){
  categ=categorias[i].split('&');
  nrocateg=categ.length-2;
  //console.log(i + ' '+categ[1]+ ' '+ nrocateg);
  Cats.add(categ[1],'Tienda');
  for (var j=2;j<=nrocateg;j++) {
     //console.log('subc '+ j+ ' '+categ[j]);
     Cats.add(categ[j],categ[j-1]);
   }
}

//console.log(Cats);
}



function muestra_cat(){
var divcat=document.getElementById("cat");
var divarbol=document.getElementById("arbol");
cat_actual=Stack_cat[Stack_cat.length-1];
var text_cat='';
for (i=0;i<Stack_cat.length;i++)
    text_cat+=Stack_cat[i]+'/';
var nodo=Cats.findBFS(cat_actual) ;
var texto='';
texto+='<center>'+text_cat+'</center>';
if (Stack_cat.length>1) {
//texto+='  '+'<button class="nav" onclick="sube_cat()";>'+'&#9650'+'</button>'
}
//texto+='<br>';
divarbol.innerHTML=texto;
//cat_ant=cat_actual;
texto='';
for (i=0;i<nodo.children.length;i++){
  var aux=nodo.children[i].value;
  texto+='  '+'<button class="bot3" onclick="cambia_cat(\''+aux+'\')";>'+aux+'</button>';

}
divcat.innerHTML=texto;
divcat.style.visibility="visible";

//divcat.hidden=false;

}
function sube_cat(){
if (Stack_cat.length>1) { 
 Stack_cat.pop();
 muestra_cat();
refresca();
//console.log('paso sube');
}
}

function cambia_cat(valor){
Stack_cat.push(valor)
cat_ant=cat_actual;
//console.log('cat anterior  '+cat_ant);
cat_actual=valor.toString();
muestra_cat();
refresca();
//console.log('paso');
}

function  set_clave_indice(){
clave_ind=new Map();
for (var i=0;i<data.length;i++) {
console.log(i);
console.log(data[i][9]);

clave_ind.set(data[i][9],i.toString());
}
}

function ordena(){
data.sort(function(a, b){
  if (a.cat<b.cat) {return -1} else {return 0;}
   });
}

var dist="Distribuidora Pita-Orozco"
var hoy=new Date();
function camb(){
var va=document.getElementById("t3").checked; 
//console.log('va '+va);
localStorage.setItem('p3',va);
}
function carga(){
data=[];

try {
nro_factura=parseInt(localStorage.getItem('FACT_NRO'));
console.log('nf '+nro_factura);
//document.getElementById("t1").value = localStorage.getItem('p1');
document.getElementById("t2").value = localStorage.getItem('p2');
document.getElementById("fecha_p").innerText = localStorage.getItem('FECHA_P');
//document.getElementById("t3").checked = localStorage.getItem('p3');
} catch (error) 
{
  console.error(error);

}

try {
data=eval(localStorage.getItem('data'));

} catch (error) 
{
  console.log(error);

}



//var fecha=document.getElementById("fecha");
//fecha.innerHTML="V 0.1 13/10/2021";
divt=document.getElementById("divt");
fiva=7.25;

var j=0;



data= [["Vacio de cerveza Ret 222 ml x 36 UN",1,63,0,0,0,"t1","&Cerveceria&Vacios&",1,'CV001'],
      ["Vacio de cerveza Ret 330 ml x 24 UN",1,63,0,0,0,"t1","&Cerveceria&Vacios&",1,'CV005'],
      ["Gavera de cerveza Ret 222 ml x 36 UN",1,12.60,0,0,0,"t1","&Cerveceria&Vacios&",1,'CV009'],
      ["Gavera de cerveza Ret 333 ml x 24 UN",1,12.60,0,0,0,"t1","&Cerveceria&Vacios&",1,'CV013'],
      ["Botella de cerveza Ret 222 ml ",1,1.40,0,0,0,"t1","&Cerveceria&Vacios&",1,'CV017'],
      ["Botella de cerveza Ret 333 ml ",1,2.10,0,0,0,"t1","&Cerveceria&Vacios&",1,'CV021'],
      ["Barril 30 lt ",1,860,0,0,0,"t1","&Cerveceria&Vacios&",0,'CV025'],
      ["Barril 50 lt ",1,970,0,0,0,"t1","&Cerveceria&Vacios&",0,'CV029'],
      ["F01001 Pilsen Ret 222 ml x 36 UN",36,14.48,1,0,0,"t3","&Cerveceria&Pilsen&Pilsen Retornable&",1,'F01001'],
      ["F01002 Pilsen Ret 330 ml x 24 UN",24,14.48,1,0,0,"t3","&Cerveceria&Pilsen&Pilsen Retornable&",1,'F01002'],
      ["F01002 (PROMO) Pilsen Ret 330 ml x 24 UN",24,12.41,1,0,0,"t3","&Cerveceria&Pilsen&Pilsen Retornable&",1,'F01002P'],
      ["F01063 Pilsen NR 355 ml x 12 UN",12,9.93,1,0,0,"t3","&Cerveceria&Pilsen&Pilsen NR&",1,'F01063'],
      ["F01077 Pilsen lata Sleek 355 ml x 12 UN",12,8.27,1,0,0,"t3","&Cerveceria&Pilsen&Pilsen NR&",1,'F01077'],   
      ["F03014 Solera Light Ret 222 ml x 36 UN",36,16.55,1,0,0,"t3","&Cerveceria&Solera&Retornable&",1,'F03014'],
      ["F03030 Solera Ret 222 ml x 36 UN",36,16.55,1,0,0,"t3","&Cerveceria&Solera&Retornable&",1,'F03030'],
      ["F03076 Solera NR 222 ml x 12 UN",12,7.025,1,0,0,"t3","&Cerveceria&Solera&NR&",1,'F03076'],
      ["F03077 Solera Light NR 222 ml x 12 UN",12,7.025,1,0,0,"t3","&Cerveceria&Solera&NR&",1,'F03077'],
      ["F04005 Light Ret 222 ml x 36 UN",36,14.48,1,0,0,"t3","&Cerveceria&Light&",1,'F04005'],
      ["F04017 Polar Light Barril 30L x 1 PZ",1,71.01,0,0,0,"t3","&Cerveceria&Light&",0,'F04017'],
      ["F04018 Polar Light Barril 50L x 1 PZ",1,118.01,0,0,0,"t3","&Cerveceria&Light&",0,'F04018'],
      ["F04043 Light NR 355 ml x 12 UN",12,9.93,1,0,0,"t3","&Cerveceria&Light&",1,'F04043'],   
      ["F04052 Light Mix Naranja NR 355 ml x 12 UN",12,9.93,1,0,0,"t3","&Cerveceria&Light&",0,'F04052'],
      ["F04053 Light Mix Toronja NR 355 ml x 12 UN",12,9.93,1,0,0,"t3","&Cerveceria&Light&",0,'F04053'],
      ["F04054 Light Mix Parchita NR 355 ml x 12 UN",12,9.93,1,0,0,"t3","&Cerveceria&Light&",0,'F04054'],
      ["F04056 Light Lata Sleek 355 ml x 12 UN",12,8.27,1,0,0,"t3","&Cerveceria&Light&",1,'F04056'],
      ["F06034 Solera Marzen  Ret 222 ml x 36 UN",36,16.55,1,0,0,"t3","&Cerveceria&Solera&Retornable&",1,'F06034'],
      ["F06037 Solera IPA Ret 222 ml x 36 UN",36,16.55,1,0,0,"t3","&Cerveceria&Solera&Retornable&",1,'F06037'],
      ["F06046 Solera Kriek Ret 222 ml x 36 UN",36,16.55,1,0,0,"t3","&Cerveceria&Solera&Retornable&",1,'F06046'],
      ["F05056 Solera Marzen NR 222 ml x 12 UN",12,7.025,1,0,0,"t3","&Cerveceria&Solera&NR&",1,'F05056'],
      ["F06057 Solera IPA NR 222 ml x 12 UN",12,7.025,1,0,0,"t3","&Cerveceria&Solera&NR&",1,'F06057'],
      ["F06058 Solera Kriek NR 222 ml x 12 UN",12,7.025,1,0,0,"t3","&Cerveceria&Solera&NR&",1,'F06058'],
      ["F06059 Solera Reserva Ret 222 ml x 36 UN",36,16.55,1,0,0,"t3","&Cerveceria&Solera&Retornable&",1,'F06059'],
      ["F06060 Solera Reserva NR 222 ml x 12 UN",12,7.025,1,0,0,"t3","&Cerveceria&Solera&NR&",1,'F06060'],
      ["FR0123 Carorena tinta 6 unid",6,34.35,1,0,0,"t3","&Cerveceria&Sangria&",1,'FR0123'],
      ["FR0120 Carorena blanca 6 unid",6,34.35,1,0,0,"t3","&Cerveceria&Sangria&",1,'FR0120'],
      ["FR0123 Carorena rosada 6 unid",6,34.35,1,0,0,"t3","&Cerveceria&Sangria&",1,'FR0123'],
      ["FR0133 Carorena verano x 36",36,28.96,1,0,0,"t3","&Cerveceria&Sangria&",1,'FR0133'],
      ["F07001 Maltin polar ret 222 ml x 36 U",36,11.18,1,0,0,"t3","&Cerveceria&Malta&Malta Retornable&",1,'F07001'],
      ["F07003 Maltin Nr.250 ml x 24 U",24,0.00,0,0,0,"t3","&Cerveceria&Malta&Malta no Retornable&",0,'F07003'],
      ["F07018 Maltin 1.5 L x 6U",6,11.67,1,0,0,"t3","&Cerveceria&Malta&Litron&",1,'F07018'],
      ["F07020 Maltin Nr/Light.250 ml x 24 U",24,0.00,0,0,0,"t3","&Cerveceria&Malta&Malta Retornable&",0,'F07020'],
      ["F07073 Maltin light 1.5 L x 6U",6,11.67,1,0,0,"t3","&Cerveceria&Malta&Litron&",1,'F07073'],
      ["F07086 Maltin polar light ret 222 ml x 36 U",36,11.18,1,0,0,"t3","&Cerveceria&Malta&Malta Retornable&",1,'F07086'],
      ["F07088 Maltin light Nr.250 ml x 12 U",12,6.327,1,0,0,"t3","&Cerveceria&Malta&Malta no Retornable&",1,'F07088'],
      ["F07089 Maltin Nr.250 ml x 12 U",12,6.327,1,0,0,"t3","&Cerveceria&Malta&Malta no Retornable&",1,'F07089'],
      ["F07090 Malta Caracas NR 250 ml x 12 U",12,6.327,1,0,0,"t3","&Cerveceria&Malta&Malta no Retornable&",0,'F07090'],
      ["F07101 Maltin polar sleek 355 ml x 24 U",24,15.077,1,0,0,"t3","&Cerveceria&Malta&Malta no Retornable&",1,'F07101'],
      ["H201 Aceite Mazeite 1 lt x 12",12,4.59,0,0,0,"t2","&Alimentos&Aceites&",1,'H201'],
      ["M324 Dogourmet Parrilla. 18 Kg x 1U",1,38.74,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1,'M324'],      
      ["M326 Dogourmet Parrilla. 2 Kg x 6U",6,5.79,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1,'M326'],
      ["M329 Dogourmet Cachorros 18 Kg x 1",1,43.62,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1,'M329'],
      ["M330 Dogourmet Cachorros 2 Kg x 6U",6,6.35,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1,'M330'],
      ["M338 Dogourmet Parrilla. 4 Kg x 5U",5,10.05,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1,'M338'],
      ["M340 Super Can.carne hueso 4 Kg x 5U",5,7.47,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1,'M340'],
      ["M033 Super Can.carne hueso 18 Kg x 1",1,28.91,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1,'M033'],
      ["M034 Super Can. pollo 18 Kg x 1",1,28.91,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1,'M034'],
      ["M347 Dogourmet Parrilla. 1 Kg x 10U",10,3.05,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1,'M347'],
      ["M800 Super Can. carne hueso 2 Kg x 6U",6,3.80,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1,'M800'],
      ["M802 Super Can.carne hueso 10 Kg x 1",1,16.90,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1,'M802'],
      ["M803 Dogourmet Cachorros 10 Kg x 1U ",1,24.29,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1,'M803'],
      ["M806 Dogourmet Parrilla. 10 Kg x 1U",1,22.11,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1,'M806'],
      ["H300 Arroz Clasico. 1 Kg x 24 ",24,1.25,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Arroz&",1,'H300'],
      ["H364 Arroz Corina. 1 Kg x 24 ",24,1.02,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Arroz&",1,'H364'],
      ["D361 Margarita Atun natural 140g x 35",35,1.77,0,0,0,"t2","&Alimentos&Enlatados&Atun&",1,'D361'],
      ["D362 Margarita Atun en aceite 140g x 35",35,1.69,1,0,0,"t2","&Alimentos&Enlatados&Atun&",1,'D362'],
      ["Q001 Avena Quaker Original (Bolsa) 400g x 24",24,1.59,0,0,0,"t2","&Alimentos&Avena&",1,'Q001'],
      ["Q002 Avena Quaker Original (Bolsa) 800g x 12",12,2.76,0,0,0,"t2","&Alimentos&Avena&",1,'Q002'],
      ["Q023 Harina Avena Quaker (Bolsa) 400g x 24",24,1.59,0,0,0,"t2","&Alimentos&Avena&",1,'Q023'],
      ["Q064 Avena fortificada 400g x 24",24,0.00,0,0,0,"t2","&Alimentos&Avena&",1,'Q064'],
      ["Q134 Avena Vainilla casera 400g x 24",24,1.59,0,0,0,"t2","&Alimentos&Avena&",1,'Q134'],
      ["Q135 Avena Sirop de Maple 400g x 24",24,1.59,0,0,0,"t2","&Alimentos&Avena&",1,'Q135'],
      ["Q136 Avena Orignal (Bolsa) 100g x 48",48,0.42,0,0,0,"t2","&Alimentos&Avena&",1,'Q136'],
      ["Q464 Avena fortificada 100g x 48",48,0.00,0,0,0,"t2","&Alimentos&Avena&",1,'Q464'],     
      ["Q465 Avena fortificada 200g x 30",30,0.00,0,0,0,"t2","&Alimentos&Avena&",1,'Q465'],
      ["Q005 Avena( Don Pancho) 400g x 24",24,1.25,0,0,0,"t2","&Alimentos&Avena&",1,'Q005'],
      ["Q006 Avena( Don Pancho) 800g x 12",12,2.17,0,0,0,"t2","&Alimentos&Avena&",1,'Q006'],
      ["Q137 Avena Orignal (Bolsa) 200g x 30",30,0.80,0,0,0,"t2","&Alimentos&Avena&",1,'Q137'],
      ["Q113 KONGA SABOR LIMON 30gx8x14",8,5.04,1,0,0,"t2","&Alimentos&Konga&",1,'Q113'],
      ["Q114 KONGA SABOR NARANJA 30gx8x14",8,5.04,1,0,0,"t2","&Alimentos&Konga&",1,'Q114'],
      ["Q115 KONGA SABOR MORA 30gx8x14 ",8,5.04,1,0,0,"t2","&Alimentos&Konga&",1,'Q115'],
      ["Q123 KONGA SABOR PARCHITA 30gx8x14",8,5.04,1,0,0,"t2","&Alimentos&Konga&",1,'Q123'],
      ["H172 Pan/Mezcla cachapas 500g x 12",12,1.56,1,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Cachapas&",0,'H172'],
      ["H330 Primor Crema/Arroz Enriq 450g x 24 Pote",24,1.42,0,0,0,"t2","&Alimentos&Cereales I&",1,'H330'],
      ["H331 Primor Crema/Arroz Enriq 900g x 12 Pote",12,2.26,0,0,0,"t2","&Alimentos&Cereales I&",1,'H331'],
      ["H369 Primor Crema/Arroz (Bolsa) 225g x 34",34,0.63,0,0,0,"t2","&Alimentos&Cereales I&",1,'H369'],
      ["H370 Crema/Arroz.(Bolsa) Enriq 450g x 24",24,1.09,0,0,0,"t2","&Alimentos&Cereales I&",1,'H370'],
      ["H371 Crema/Arroz.(Bolsa) Enrriq( 900g x 12 Bolsa",12,1.73,0,0,0,"t2","&Alimentos&Cereales I&",1,'H371'],
      ["Q099 Toddy. Chips Galleta (24gx6)x24 ",24,2.40,1,0,0,"t2","&Alimentos&Varios&Galletas&",0,'Q099'],
      ["Q138 Toddy. Chips Galleta (24gx4)x40 ",40,1.48,1,0,0,"t2","&Alimentos&Varios&Galletas&",0,'Q138'],
      ["Y065 Pudin Toddy. (125gx6)x24 ",24,0.67,1,0,0,"t2","&Alimentos&Varios&Pudin&",0,'Y065'],
      ["Q101 Gelatina Golden Fresa 96 gr x 10U",10,14.50,1,0,0,"t2","&Alimentos&Varios&Gelatinas&",0,'Q101'],
      ["Q102 Gelatina Golden Kolita 96 gr x 10U",10,14.50,1,0,0,"t2","&Alimentos&Varios&Gelatinas&",0,'Q102'],
      ["Q103 Gelatina Golden Uva 96 gr x 10U",10,14.50,1,0,0,"t2","&Alimentos&Varios&Gelatinas&",0,'Q103'],
      ["Q107 Gelatina Golden Frambuesa 96 gr x 10U",10,14.50,1,0,0,"t2","&Alimentos&Varios&Gelatinas&",1,'Q107'],
      ["H135 Harina Pan tradicional 1 k x 20",20,1.28,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Harinas de Maiz&",1,'H135'],
      ["H136 Harina Pan Amarilla k x 20",20,1.28,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Harinas de Maiz&",1,'H136'],
      ["H173 Harina Pan/Arroz 1 k x 20",20,1.16,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Harinas de Maiz&",1,'H173'],
      ["T060 Salsa/Tomate.198 x 24",24,0.90,1,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Ketchup&",1,'T060'],
      ["T061 Salsa/Tomate.397 x 24",24,1.41,1,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Ketchup&",1,'T061'],
      ["T449 Salsa/Tomate. 4,2 x 4",4,13.21,1,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Ketchup&",1,'T449'],
      ["T076 Chef Margarina 5 K x 1.C/S",1,19.24,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Margarinas&Chef&",1,'T076'],
      ["T080 Chef Margarina 5 K x 1.S/S",1,19.24,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Margarinas&Chef&",1,'T080'],
      ["T084 Mantequilla Mavesa 1 K x 6",6,4.06,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Margarinas&Mavesa&",1,'T084'],
      ["T086 Mantequilla Mavesa 500g x 12",12,2.09,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Margarinas&Mavesa&",1,'T086'],
      ["T572 Mantequilla Mavesa 250g x 24",24,1.13,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Margarinas&Mavesa&",1,'T572'],
      ["T578 Mantequilla Nelly CR 400g x 12",12,0.99,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Margarinas&Nelly&",1,'T578'],
      ["T587 Mantequilla Nelly CR 250g x 24",24,0.99,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Margarinas&Nelly&",1,'T587'],
      ["T588 Mantequilla Nelly CR 500g x 12",12,1.87,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Margarinas&Nelly&",1,'T588'],
      ["T018 Mayonesa 910g x 6",6,6.56,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Mayonesas&",1,'T018'],
      ["T019 Mayonesa 175g x 18",18,1.71,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Mayonesas&",1,'T019'],
      ["T020 Mayonesa 445g x 12",12,3.49,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Mayonesas&",1,'T020'],
      ["T393 Mayonesa 445g x 12 ND",12,3.49,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Mayonesas&",1,'T393'],
      ["T486 Mayonesa(Aderezo) 3,6 kg x 4",4,23.99,1,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Mayonesas&",1,'T486'],
      ["T409 Mayonesa  Stock 175g x 24 U",24,1.71,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Mayonesas&",1,'T409'],
      ["T573 Mayonesa  Stock 175g x 24 U",24,1.71,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Mayonesas&",1,'T573'],
      ["T574 Mayonesa limon  445 g x 12",12,3.49,0,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Mayonesas&",1,'T574'],
      ["T001 Toddy. 1 Kg x 12U Bolsa",12,8.71,1,0,0,"t2","&Alimentos&Toddy&",1,'T001'],
      ["T002 Toddy. 2 Kg x 8U. Bolsa",8,16.32,1,0,0,"t2","&Alimentos&Toddy&",1,'T002'],
      ["T003 Toddy. 400g x 24U Bolsa",24,3.95,1,0,0,"t2","&Alimentos&Toddy&",1,'T003'],
      ["T007 Toddy. 400g x 12U Pote",12,3.95,1,0,0,"t2","&Alimentos&Toddy&",1,'T007'],
      ["T472 Toddy. 200g x 12U Pote",12,2.09,1,0,0,"t2","&Alimentos&Toddy&",1,'T472'],
      ["T568 Toddy. 100g x 36U Bolsa",36,1.11,1,0,0,"t2","&Alimentos&Toddy&",1,'T568'],
      ["T427 Aceite Chef Oleina de Palma.18 Lt x 1U",1,63.96,0,0,0,"t2","&Alimentos&Aceites&",1,'T427'],
      ["T584 Aceite Super Oleina de Palma.1 Lt x 12U",12,3.04,0,0,0,"t2","&Alimentos&Aceites&",1,'T584'],
      ["H500 Pasta corta dedales 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Corta&",1,'H500'],
      ["H501 Pasta corta tornillo 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Corta&",1,'H501'],
      ["H506 Pasta corta plumitas 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Corta&",1,'H506'],
      ["H509 Pasta corta dedales 500g x 12U",12,0.91,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Corta&",1,'H509'],
      ["H516 Pasta larga vermicelli 500g x 12U",12,0.91,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1,'H516'],
      ["H517 Pasta larga spaguetti 500g x 12U",12,0.91,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1,'H517'],
      ["H689 Pasta larga vermicelli 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1,'H689'],
      ["H690 Pasta larga spaguetti 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1,'H690'],
      ["H1804 Pasta larga Linguini. 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1,'H1804'],
      ["H892 Primor especial vermicelli 1 K x 12U",12,1.51,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Especial&",0,'H892'],
      ["H893 Primor especial plumitas 1 K x 12U",12,1.51,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Especial&",0,'H893'],
      ["H894 Primor especial tornillos 1 K x 12U",12,1.51,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Especial&",0,'H894'],
      ["H895 Primor especial dedales 1 K x 12U",12,1.51,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Especial&",0,'H895'],
      ["D366 Pepitonas picantes 140g x 35 ",35,1.35,1,0,0,"t2","&Alimentos&Enlatados&Pepitonas&",1,'D366'],
      ["D388 Bonito en aceite 140g x 35",35,1.48,1,0,0,"t2","&Alimentos&Enlatados&Bonito&",1,'D388'],
      ["T499 Rikesa Trad.200 x 18",18,2.33,1,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Rikesa&",1,'T499'],
      ["T500 Rikesa Trad.300 x 12",12,3.36,1,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Rikesa&",1,'T500'],
      ["T501 Rikesa Tocineta.300 x 12",12,3.36,1,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Rikesa&",1,'T501'],
      ["T564 Rikesa Blanco.200g x 18U",18,2.33,1,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Rikesa&",1,'T564'],
      ["T565 Rikesa Parmesano 200g x 18U",18,2.33,1,0,0,"t2","&Alimentos&Margarinas Mayonesa Rikesa Ketchup&Rikesa&",1,'T565'],
      ["D384 Sardina Aceite.170 x 20",20,1.42,0,0,0,"t2","&Alimentos&Enlatados&Sardinas&",1,'D384'],
      ["D385 Sardina Picante.170x 20",20,1.42,0,0,0,"t2","&Alimentos&Enlatados&Sardinas&",1,'D385'],
      ["D386 Sardina Tomate.170x 20",20,1.42,0,0,0,"t2","&Alimentos&Enlatados&Sardinas&",1,'D386'],
      ["T297 Mermelada Vienesa Fresa 240g x 18U",18,2.16,1,0,0,"t2","&Alimentos&Varios&Mermeladas&",0,'T297'],
      ["T298 Mermelada Vienesa Guayaba 240g x 18U",18,2.16,1,0,0,"t2","&Alimentos&Varios&Mermeladas&",0,'T298'],
      ["T583 Mermelada Vienesa Fresamora 240g x 18U",18,2.16,1,0,0,"t2","&Alimentos&Varios&Mermeladas&",0,'T583'],
      ["T048 Vinagre. 1 lt x 12",12,1.34,1,0,0,"t2","&Alimentos&Vinagres&",1,'T048'],
      ["T049 Vinagre. 1/2 lt x 24",24,0.80,1,0,0,"t2","&Alimentos&Vinagres&",1,'T049'],
      ["T533 Vinagre. 4 lt x 4",4,5.31,1,0,0,"t2","&Alimentos&Vinagres&",0,'T533'],
      ["D390 Primor Caraotas negras sazonadas 220gx24U",20,0.89,1,0,0,"t2","&Alimentos&Enlatados&Caraotas&",0,'D390'],
      ["D391 Primor Frijoles sazonados 220gx24U",20,0.89,1,0,0,"t2","&Alimentos&Enlatados&Frijoles&",0,'D391'],
      ["D392 Primor Caraotas negras sazonadas 420gx12U",12,1.67,1,0,0,"t2","&Alimentos&Enlatados&Caraotas&",0,'D392'],
      ["D393 Primor Frijoles sazonados 420gx12U",12,1.67,1,0,0,"t2","&Alimentos&Enlatados&Frijoles&",0,'D393'],
      ["Y001 Yogurt Fruta Fresa Migurt 125gx24",24,1.35,1,0,0,"t2","&Alimentos&Varios&Yogurt&",0,'Y001'],
      ["Y002 Yogurt Fruta Durazno Migurt 125 x 24",24,1.35,1,0,0,"t2","&Alimentos&Varios&Yogurt&",0,'Y002'],
      ["Y004 Yogurt Fruta Fresa Migurt 250 x 24",24,2.45,1,0,0,"t2","&Alimentos&Varios&Yogurt&",0,'Y004'],
      ["Y005 Yogurt Fruta durazno Migurt 250 x 24",24,2.45,1,0,0,"t2","&Alimentos&Varios&Yogurt&",0,'Y005'],
      ["Y007 Yogurt Fruta Fresa Migurt 750 x 12",12,6.06,1,0,0,"t2","&Alimentos&Varios&Yogurt&",0,'Y007'],
      ["Y008 Yogurt Fruta Durazno Migurt 750 x 12",12,6.06,1,0,0,"t2","&Alimentos&Varios&Yogurt&",0,'Y008'],
      ["Y009 Yogurt sabor dulce Migurt 750 x 12",12,6.06,1,0,0,"t2","&Alimentos&Varios&Yogurt&",0,'Y009'],
      ["Y036 Yogurt sabor fresa Migurt 125 x 24",24,1.30,1,0,0,"t2","&Alimentos&Varios&Yogurt&",0,'Y036'],
      ["L260 Las llaves Detergente Bebe 400g x 30",30,1.38,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1,'L260'],
      ["L073 Las llaves Detergente P. LI 900g x 20",20,3.05,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1,'L073'],
      ["L081 Las llaves Detergente Floral 400g x 30",20,1.38,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1,'L081'],
      ["L082 Las llaves Detergente Floral 900g x 20",20,3.05,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1,'L082'],
      ["L255 Las llaves Detergente Bebe 900g x 20",20,3.05,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1,'L255'],
      ["L350 Las llaves Detergente liq.Bebe 1L x 12",12,5.75,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",0,'L350'],
      ["L367 Las llaves Detergente liq.ROPA DELI.510cc x 12",12,3.21,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",0,'L367'],
      ["L382 Multiclean Detergente Frag citrica 900g x 20",20,1.59,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1,'L382'],
      ["L383 Multiclean Detergente Frag citrica 400g x 30U",30,0.73,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1,'L383'],
      ["L384 Multiclean Detergente Frag citrica 5 Kg x 4U",4,8.79,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1,'L384'],
      ["L207 Llaves Panela Trad Floral 250 x 36",36,0.87,1,0,0,"t2","&Alimentos&Limpieza&Jabones&",1,'L207'],
      ["L275 LLaves Jabon FF.BEBE.160 g x 48U",48,0.72,1,0,0,"t2","&Alimentos&Limpieza&Jabones&",1,'L275'],
      ["L376 Jabon Panela.Floral.200 x 44",44,0.72,1,0,0,"t2","&Alimentos&Limpieza&Jabones&",1,'L376'],
      ["L389 Multi Clean jabon Frag citrica 200 g x 44U",44,0.48,1,0,0,"t2","&Alimentos&Limpieza&Jabones&",1,'L389'],     
      ["L379 LLaves Lav. Antib liq. 500cc x 18U",18,3.07,1,0,0,"t2","&Alimentos&Limpieza&Lavaplatos&",0,'L379'],
      ["L387 LLaves Lav. Antib liq. 500cc x 18U",18,3.07,1,0,0,"t2","&Alimentos&Limpieza&Lavaplatos&",0,'L387'],     
      ["L371 LLaves Limp. Marea Cristalina 1L x 12",12,2.70,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",1,'L371'],
      ["L372 LLaves Limp. Brisa Tropical 1L x 12",12,2.70,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",1,'L372'],
      ["L377 LLaves Limp. Marea Cristalina 500cc  x 24",24,1.53,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",0,'L377'],
      ["L378 LLaves Limp. Brisa Tropical 500cc x 24U",24,1.53,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",0,'L378'],
      ["L385 Llaves Limp. Bosque sereno 500cc x 24U",24,1.53,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",0,'L385'],
      ["L386 Llaves Limp. Bosque sereno 1 L x 12U",12,2.70,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",0,'L386'],
      ["L357 Jabon Crema Multiuso.250g x 36U",36,1.96,1,0,0,"t2","&Alimentos&Limpieza&Multiuso&",1,'L357'],
      ["L358 Jabon Crema Multiuso.500g x 18U",18,3.56,1,0,0,"t2","&Alimentos&Limpieza&Multiuso&",1,'L358'],
      ["L373 Jabon pastilla Multiuso 130g x 42U",42,1.00,1,0,0,"t2","&Alimentos&Limpieza&Multiuso&",1,'L373'],
      ["L374 Las llaves Suavizante Bebe  950cc x 12U",12,4.00,1,0,0,"t2","&Alimentos&Limpieza&Suavizantes&",1,'L374'],
      ["L380 Las llaves Suavizante Bebe 530cc x 12U",12,2.38,1,0,0,"t2","&Alimentos&Limpieza&Suavizantes&",1,'L380'],
      ["PepsiCola 350 ml x 24",24,10.192,1,0,0,"t3","&Pepsicola&Pepsi&Botella&",1,'PP004'],
      ["PepsiCola lata 355 ml x 24",24,21.23,1,0,0,"t3","&Pepsicola&Pepsi&Lata&",1,'PP008'],
      [" 1/4 PepsiCola lata 355 ml x 6",6,5.31,1,0,0,"t3","&Pepsicola&Pepsi&Lata&",1,'PP012'],
      [" PepsiCola lata 320 ml x 24",24,21.23,1,0,0,"t3","&Pepsicola&Pepsi&Lata&",1,'PP016'],
      [" 1/4 PepsiCola lata 320 ml x 6",6,5.31,1,0,0,"t3","&Pepsicola&Pepsi&Lata&",1,'PP020'],
      [" PepsiCola PET 600 ml x 12",12,7.54,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1,'PP024'],
      [" PepsiCola PET 1,5 L x 12",12,16.03,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1,'PP028'],
      [" PepsiCola MAX PET 1,5 L ml x 12",12,10.78,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1,'PP032'],
      [" PepsiCola PET 1,5 L x 6",6,8.02,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1,'PP036'],
      [" PepsiCola MAX PET 1,5 L  x 6",6,5.39,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1,'PP040'],
      [" PepsiCola PET 2 L  x 6",6,10.34,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1,'PP042'],
      [" PepsiCola MAX PET 2 L  x 6",6,7.19,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1,'PP046'],
      [" PepsiCola PET 1 L x 6",6,6.06,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1,'PP050'],
      [" PepsiCola PET 1,25 L x 6",6,4.83,1,0,0,"t3","&Pepsicola&Pepsi&Botella&",1,'PP054'],
      [" PepsiCola PSH 250 ml x 24",24,17.638,1,0,0,"t3","&Pepsicola&Pepsi&PSH&",1,'PP058'],
      [" PepsiCola PSH 250 ml x 12",12,8.81,1,0,0,"t3","&Pepsicola&Pepsi&PSH&",1,'PP062'],
      [" Mezcladores  PSH 250 ml x 24",24,17.65,1,0,0,"t3","&Pepsicola&Mezcladores&",1,'PM004'], 
      [" Mezcladores  Lata 355 ml x 24",24,20.19,1,0,0,"t3","&Pepsicola&Mezcladores&",1,'PM008'], 
      [" Mezcladores  1/4 Caja Lata 355 ml x 6",6,5.05,1,0,0,"t3","&Pepsicola&Mezcladores&",1,'PM012'], 
      [" Minalba SPARKLING 330 ml x 24",24,11.45,1,0,0,"t3","&Pepsicola&Minalba&",1,'PM016'], 
      [" Minalba SPARKLING PET 500 ml x 24",24,19.02,1,0,0,"t3","&Pepsicola&Minalba&",1,'PM020'], 
      [" Minalba SPARKLING PET 1/2 500 ml x 12",12,9.51,1,0,0,"t3","&Pepsicola&Minalba&",1,'PM024'], 
      [" Minalba SPARKLING 1 L x 6",6,8.21,1,0,0,"t3","&Pepsicola&Minalba&",1,'PM028'], 
      [" Minalba PET 355 ml x 24",24,9.55,1,0,0,"t3","&Pepsicola&Minalba&",1,'PM032'], 
      [" Minalba PET 600 ml TR x 24",24,12.17,1,0,0,"t3","&Pepsicola&Minalba&",1,'PM036'], 
      [" Minalba PET 1.5 L x 12",12,12.27,1,0,0,"t3","&Pepsicola&Minalba&",1,'PM040'], 
      [" Minalba PET 5 L x 2",2,5.94,1,0,0,"t3","&Pepsicola&Minalba&",1,'PM044'], 
      [" Gatorade 250 ml x 24",24,10.61,1,0,0,"t3","&Pepsicola&Gatorade&",1,'PG004'], 
      [" Gatorade 500 ml x 12",12,15.98,1,0,0,"t3","&Pepsicola&Gatorade&",1,'PG008'], 
      [" YUKY-PAK 250 ml x 24",24,16.78,1,0,0,"t3","&Pepsicola&Yukery&",1,'PY004'],  
      [" Yukery Botella 250 ml x 24",24,16.78,1,0,0,"t3","&Pepsicola&Yukery&",1,'PY008'],  
      [" Yukery Botella 250 ml x 12",12,8.39,1,0,0,"t3","&Pepsicola&Yukery&",1,'PY012'],  
      [" Yukery Lata 335 ml x 24",24,13.40,1,0,0,"t3","&Pepsicola&Yukery&",1,'PY016'],  
      [" Yukery PET 500 ml x 12",12,13.55,1,0,0,"t3","&Pepsicola&Yukery&",1,'PY020'],  
      [" Yukery PET 1.5 L x 12",12,33.65,1,0,0,"t3","&Pepsicola&Yukery&",1,'PY024'],  
      [" Yukery PET 1.5 L x 6",6,16.82,1,0,0,"t3","&Pepsicola&Yukery&",1,'PY028'],  
      [" Yuky FreeSH 1.5 L x 6",6,8.41,1,0,0,"t3","&Pepsicola&Yukery&",1,'PY032'],  
      [" Yuky FreeSH PET 500 ml x 12",12,8.41,1,0,0,"t3","&Pepsicola&Yukery&",1,'PY00436'],  
      [" Te Lipton Botella 250 ml x 24",24,10.63,1,0,0,"t3","&Pepsicola&Te Lipton&",1,'PT004'],  
      [" Te Lipton Lata 335 ml x 24",24,14.67,1,0,0,"t3","&Pepsicola&Te Lipton&",1,'PT008'],  
      [" Te Lipton PET 500 ml x 12",24,13.45,1,0,0,"t3","&Pepsicola&Te Lipton&",1,'PT012'],  
      [" Te Lipton PET 1.5 L x 6",6,16.82,1,0,0,"t3","&Pepsicola&Te Lipton&",1,'PT016'],  
      [" Botella 350 ml",1,0.20,0,0,0,"t2","&Pepsicola&Vacios_Pepsi&",1,'PV004'],  
      [" Botella 1.25 L",1,0.51,0,0,0,"t2","&Pepsicola&Vacios_Pepsi&",1,'PV008'], 
      [" Gavera plastica 350 ml",1,2.01,0,0,0,"t2","&Pepsicola&Vacios_Pepsi&",1,'PV012'],  
      [" Gavera plastica 1.25 L",1,4.02,0,0,0,"t2","&Pepsicola&Vacios_Pepsi&",1,'PV016']  
];
set_cat();
muestra_cat();
set_clave_indice();
inicio_inventario();
refresca();
recupera_pedido("Pedido");
}
function actT(ind){
var valor=prompt("Introduzca cantidad", "");
if (valor!=null) {data[ind][5]=parseInt(valor);}
intro(ind);

//console.log(ind);
}
function actU(ind){
var valor=prompt("Introduzca cantidad", "");
if (valor!=null) {data[ind][4]=parseInt(valor);}
intro(ind);

//console.log(ind);
}
var factflag=true;
function factura(){
if (factflag) {factflag=false; factura2(); } else { factflag=true; quitar()};

}
var Ftexto;

function fecha_actual(){
var dia=(hoy.getDate()).toString() ;
if (dia.length==1) {dia='0'+dia}
var mes=(hoy.getMonth()+1).toString();
if (mes.length==1) {mes='0'+mes}
return dia + '/' +mes + '/' +hoy.getFullYear().toString()

}

function factura3(){
var Tbs;
var totaldsiva=0;
var totalbsiva=0;
var texto='Fecha: '+fecha_factura+'<br>';
texto+=dist+'<br>';
texto+='Cliente: '+cliente_factura+'<br>';
var bcv=parseFloat(bcv_factura);
texto+='$ BCV: '+ (bcv).toFixed(4) +'<br>';
texto+='<center>Factura '+numero_factura+'</center>';
texto+='<center><span id="contad" ></span></center>';
var totald=0;
var totalb=0;
Ftexto='Fecha: '+fecha_factura+'\n';
Ftexto+=dist+'\n';
Ftexto+='Cliente: '+cliente_factura+'\n';
Ftexto+='$ BCV: '+  (bcv).toFixed(4) +'\n';
Ftexto+="FACTURA "+numero_factura+"\n"
var contador=0;
var colorb='black';
for (var i=0;i<datfac.length;i++){
 if (datfac[i].unidad!=0 || datfac[i].cajas!=0) {
 contador++;
 console.log(i+ " "+contador);
 factor=bcv;
 if (data[i][3]==1) {fm=1.16;colorb='black';} else {fm=1;colorb='blue';}

 pu=datfac[i].pu;
 pb=datfac[i].pb;
 var Tdolar=+((datfac[i].unidad*pu + datfac[i].cajas*pb));
    Tbs=Tdolar*factor;

if (Tdolar!=0) { 
  //totald+=Tdolar*fm;
  //totaldsiva+=parseFloat((Tdolar).toFixed(2));
  //totalb+=Tbs*fm;
  //totalbsiva+=parseFloat(Tbs.toFixed(2));
  Ftexto+='------------\n';
 // if (tipo==0) {texto+='<table width="100%">';} else  {texto+='<table style="font-size:1em;" width="100%">';}
 texto+='<table width="100%">';
 if (tipo2==0) {var mone=' $'; var fc=1 }
 if (tipo2==1) {var mone=' Bs'; var fc=bcv }
    if (datfac[i].unidad!=0) { 
      v2=(pu*fc).toFixed(2);
      v3=(parseFloat(v2)*datfac[i].unidad).toFixed(2);
      v4=(parseFloat(v3)*fm).toFixed(2);
      if (tipo2==1) {totalb+=parseFloat(v4); totalbsiva+=parseFloat(v3);} else 
         {totald+=parseFloat(v4); totaldsiva+=parseFloat(v3);}
         texto+='<tr><td colspan="4" style=" font-size:1.5em;background-color:'+colorb+';color:white;" >'+ datfac[i].unidad +' U '+ data[i][0]+'</td></tr>';
         texto+='<tr style="text-align:right;font-size:0.5em;"><td style="width:10%;">'+datfac[i].unidad+'</td><td style="width:30%;">'+v2+mone+'</td><td style="width:30%;">'+v3+mone+'</td><td style="width:30%;">'+ v4 +mone+'&nbsp'+'</tr>';
         Ftexto+=datfac[i].unidad +' U '+ data[i][0]+'\n';
         Ftexto+=datfac[i].unidad+' U     '+v2+mone+' S/IVA: '+v3+mone+"   C/IVA: "+ v4 + mone +'    \n'
    }
   if (datfac[i].cajas!=0) {
      v2=(pb*fc).toFixed(2);
      v3=(parseFloat(v2)*datfac[i].cajas).toFixed(2);
      v4=(parseFloat(v3)*fm).toFixed(2);
      if (tipo2==1) {totalb+=parseFloat(v4); totalbsiva+=parseFloat(v3);} else 
         {totald+=parseFloat(v4); totaldsiva+=parseFloat(v3);}
      texto+='<tr><td colspan="4" style="font-size:1.5em;background-color:'+colorb+';color:white;" >'+ datfac[i].cajas +' C  ' + data[i][0]+' </td></tr>';
      texto+='<tr style="text-align:right;font-size:0.5em;"><td style="width:10%;">'+datfac[i].cajas+'</td><td style="width:30%;">'+v2+mone+'</td><td style="width:30%;">'+v3+mone+'</td><td style="width:30%;">'+ v4 +mone+'&nbsp'+'</tr>';
      Ftexto+=datfac[i].cajas +' C '+ data[i][0]+'\n';;
      Ftexto+=datfac[i].cajas +' C     '+v2+mone+' S/IVA: '+v3+"   C/IVA: "+v4 + mone+'    \n'
    }
}
}
}
texto+='</table>';


texto+='<HR>';
Ftexto+='============================================\n';
//texto+='<span style="color:yellow; font-size:1em;">Total</span><br>';

if (tipo2==0){
texto+='<table width="100%"><tr align="right"><td style="width:15%;"> </td><td style="width:15%;"></td><td style="width:35%;">'+'S/IVA'+'</td><td style="width:35%;">'+'C/IVA'+'</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> Total </td><td style="width:15%;"></td><td style="width:35%;">'+(totaldsiva).toFixed(2)+' $ </td><td style="width:35%;">'+(totald).toFixed(2)+' $&nbsp</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> IVA </td><td style="width:15%;"></td><td style="width:35%;">'+(totald-totaldsiva).toFixed(2)+' $ </td><td style="width:35%;">'+''+'</td></tr></table>';
//texto+='<table width="100%"><tr align="right"><td style="width:20%;"> </td><td style="width:20%;"></td><td style="width:30%;">'+(totalbsiva).toFixed(2)+' Bs </td><td style="width:30%;">'+(totalb).toFixed(2)+' Bs&nbsp</td></tr></table>';

Ftexto+='S/IVA: '+(totaldsiva).toFixed(2)+'$  C/IVA: '+(totald).toFixed(2)+' $ \n'
Ftexto+='IVA: '+(totald-totaldsiva).toFixed(2)+'$\n';
}


if (tipo2==1) {
texto+='<table width="100%"><tr align="right"><td style="width:15%;"> </td><td style="width:15%;"></td><td style="width:35%;">'+'S/IVA'+'</td><td style="width:35%;">'+'C/IVA'+'</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> Total </td><td style="width:15%;"></td><td style="width:35%;">'+(totalbsiva).toFixed(2)+' Bs </td><td style="width:35%;">'+(totalb).toFixed(2)+' Bs&nbsp</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> IVA </td><td style="width:15%;"></td><td style="width:35%;">'+(totalb-totalbsiva).toFixed(2)+' Bs </td><td style="width:35%;">'+''+'</td></tr></table>';
//texto+='<table width="100%"><tr align="right"><td style="width:20%;"> </td><td style="width:20%;"></td><td style="width:30%;">'+(totalbsiva).toFixed(2)+' Bs </td><td style="width:30%;">'+(totalb).toFixed(2)+' Bs&nbsp</td></tr></table>';

Ftexto+='S/IVA: '+(totalbsiva).toFixed(2)+'Bs C/IVA: '+(totalb).toFixed(2)+' Bs \n'
Ftexto+='IVA: '+(totalb-totalbsiva).toFixed(2)+'Bs\n';
}
console.log(Ftexto);

var TM2="";
if (tipo2==0) {TM2="$";} else {TM2="Bs";}

var textoT='<div style="position: fixed; text-align:right;background-color: gray;width:100%;">';
textoT+='<button style="font-size: 0.9em;" title="Cambia moneda" id="tipo_factura" onclick="cambia_moneda2();">' + TM2 + '</button>&nbsp<button style="font-size: 0.9em;" title="Compartir" id="btnc" onclick="compartir();"> C </button> <button  style="font-size: 0.9em;" title="Salir" onclick="quitar();" > x </button></div><br>';
divfactura=document.getElementById("factura")
divfactura.style="position: fixed;top :35px; left: 2px; overflow-y: auto; width: 100% ; height: 80%; background-color: lightgray;color:white; border: 3px solid #73AD21;";
textoT+='<div style="color:black; font-size:0.8em;">'+texto+'</div>';
divfactura.innerHTML=textoT;
divfactura.hidden=false;
console.log("contador: "+contador);
document.getElementById("contad").innerText=contador+ " Productos";
}


function factura2(){
var Tbs;
var totaldsiva=0;
var totalbsiva=0;
var texto='Fecha: '+fecha_actual()+'<br>';
texto+=dist+'<br>';
texto+='Cliente: '+cliente+'<br>';
//texto+='$ Paralelo: '+  impri(document.getElementById("t1").value) +'<br>';
var bcv=parseFloat(document.getElementById("t2").value);
texto+='$ BCV: '+ (bcv).toFixed(4) +'<br>';
texto+="<center>Factura</center>";
texto+='<center><span id="contad" ></span></center>';
var totald=0;
var totalb=0;
Ftexto='Fecha: '+fecha_actual()+'\n';
Ftexto+=dist+'\n';
Ftexto+='Cliente: '+cliente+'\n';
//Ftexto+='$ Paralelo: '+  impri(document.getElementById("t1").value) +'\n';
Ftexto+='$ BCV: '+  (bcv).toFixed(4) +'\n';
Ftexto+="FACTURA\n"
var contador=0;
var colorb='black';
for (var i=0;i<data.length;i++){
if (data[i][4]!=0 || data[i][5]!=0) {
contador++;
//console.log(i+ " "+contador);
factor=parseFloat(document.getElementById("t2").value);
if (data[i][3]==1) {fm=1.16;colorb='black'} else {fm=1;colorb='blue'}
[pu,pb]=precio(i);
var Tdolar=+((data[i][4]*pu + data[i][5]*pb));
   if (data[i][6]=="t1") {
   Tbs= data[i][4]*(data[i][2]) + data[i][5]*data[i][2]*data[i][1];
   } else 
        {
    Tbs=parseFloat((Tdolar*factor).toFixed(2));
   }

if (Tdolar!=0) { 
  totald+=parseFloat((Tdolar*fm).toFixed(2));
  totaldsiva+=parseFloat((Tdolar).toFixed(2));
  //totalb+=parseFloat((Tbs*fm).toFixed(2));
  //totalbsiva+=parseFloat(Tbs.toFixed(2));
  Ftexto+='------------\n';
 // if (tipo==0) {texto+='<table width="100%">';} else  {texto+='<table style="font-size:1em;" width="100%">';}
 texto+='<table width="100%">';
 if (tipo==0) {
    if (data[i][4]!=0) { 
     v2=(pu).toFixed(2);
     v3=(parseFloat(v2)*data[i][4]).toFixed(2);
     v4=(parseFloat(v3)*fm).toFixed(2);

         texto+='<tr><td colspan="4" style=" font-size:1.5em;background-color:'+colorb+';color:white;" onclick="cintro('+i+');">'+ data[i][4] +' U '+ data[i][0]+'</td></tr>';
         texto+='<tr style="text-align:right;font-size:0.5em;"><td style="width:10%;">'+data[i][4]+'</td><td style="width:30%;">'+v2+'$'+'</td><td style="width:30%;">'+v3+' $'+'</td><td style="width:30%;">'+ v4 +' $&nbsp'+'</tr>';
         Ftexto+=data[i][4] +' U '+ data[i][0]+'\n';
         Ftexto+=data[i][4]+' U     '+v2+' $'+'S/IVA: '+v3+"   C/IVA: "+v4 + ' $    \n'
    }
   if (data[i][5]!=0) {
     v2=(pb).toFixed(2);
     v3=(parseFloat(v2)*data[i][5]).toFixed(2);
     v4=(parseFloat(v3)*fm).toFixed(2);
      texto+='<tr><td colspan="4" style="font-size:1.5em;background-color:'+colorb+';color:white;" onclick="cintro('+i+');">'+ data[i][5] +' C  ' + data[i][0]+' </td></tr>';
      texto+='<tr style="text-align:right;font-size:0.5em;"><td style="width:10%;">'+data[i][5]+'</td><td style="width:30%;">'+v2+'$'+'</td><td style="width:30%;">'+v3+' $'+'</td><td style="width:30%;">'+v4 +' $&nbsp'+'</tr>';
      Ftexto+=data[i][5] +' C '+ data[i][0]+'\n';;
      Ftexto+=data[i][5]+' C     '+v2+' $'+'S/IVA: '+v3+"   C/IVA: "+v4 + ' $    \n'
    }
}

 if (tipo==1) {
    if (data[i][4]!=0) { 
  v2=(pu*factor).toFixed(2);
  v3=(parseFloat(v2)*data[i][4]).toFixed(2);
  v4=(parseFloat(v3)*fm).toFixed(2);
  totalb+=parseFloat(v4);
  totalbsiva+=parseFloat(v3);

         texto+='<tr><td colspan="4" style=" font-size:1.5em;background-color:'+colorb+';color:'+colorb+';" onclick="cintro('+i+');">'+ data[i][4] +' U '+ data[i][0]+'</td></tr>';
         texto+='<tr style="text-align:right;font-size:0.3em;"><td style="width:10%;">'+data[i][4]+'</td><td style="width:30%;">'+v2+'Bs'+'</td><td style="width:30%;">'+v3+' Bs'+'</td><td style="width:30%;">'+ v4 +' Bs&nbsp'+'</tr>';
         Ftexto+=data[i][4] +' U '+ data[i][0]+'\n';
         Ftexto+=data[i][4]+' U     '+v2+' Bs'+'S/IVA: '+v3+"   C/IVA: "+v4 + ' Bs    \n'
    }
   if (data[i][5]!=0) {
  v2=(pb*factor).toFixed(2);
  v3=(parseFloat(v2)*data[i][5]).toFixed(2);
  v4=(parseFloat(v3)*fm).toFixed(2);
  totalb+=parseFloat(v4);
  totalbsiva+=parseFloat(v3);
      texto+='<tr><td colspan="4" style="font-size:1.5em;background-color:'+colorb+';color:white;" onclick="cintro('+i+');">'+ data[i][5] +' C  ' + data[i][0]+' </td></tr>';
      texto+='<tr style="text-align:right;font-size:0.3em;"><td style="width:10%;">'+data[i][5]+'</td><td style="width:30%;">'+v2+'Bs'+'</td><td style="width:30%;">'+v3+' Bs'+'</td><td style="width:30%;">'+ v4 +' Bs&nbsp'+'</tr>';
      Ftexto+=data[i][5] +' C '+ data[i][0]+'\n';;
      Ftexto+=data[i][5]+' C     '+v2+' Bs'+'S/IVA: '+v3+"   C/IVA: "+v4 + ' Bs    \n'
    }
}



}
texto+='</table>';
}
}


texto+='<HR>';
Ftexto+='============================================\n';
//texto+='<span style="color:yellow; font-size:1em;">Total</span><br>';
if (tipo==0) {
texto+='<table width="100%"><tr align="right"><td style="width:15%;"> </td><td style="width:15%;"></td><td style="width:35%;">'+'S/IVA'+'</td><td style="width:35%;">'+'C/IVA'+'</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> Total </td><td style="width:15%;"></td><td style="width:35%;">'+(totaldsiva).toFixed(2)+' $ </td><td style="width:35%;">'+(totald).toFixed(2)+' $&nbsp</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> IVA </td><td style="width:15%;"></td><td style="width:35%;">'+(totald-totaldsiva).toFixed(2)+' $ </td><td style="width:35%;">'+''+'</td></tr></table>';
//texto+='<table width="100%"><tr align="right"><td style="width:20%;"> </td><td style="width:20%;"></td><td style="width:30%;">'+(totalbsiva).toFixed(2)+' Bs </td><td style="width:30%;">'+(totalb).toFixed(2)+' Bs&nbsp</td></tr></table>';

Ftexto+='S/IVA: '+(totaldsiva).toFixed(2)+'$  C/IVA: '+(totald).toFixed(2)+' $ \n'
Ftexto+='IVA: '+(totald-totaldsiva).toFixed(2)+'$\n';

}

if (tipo==1) {
texto+='<table width="100%"><tr align="right"><td style="width:15%;"> </td><td style="width:15%;"></td><td style="width:35%;">'+'S/IVA'+'</td><td style="width:35%;">'+'C/IVA'+'</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> Total </td><td style="width:15%;"></td><td style="width:35%;">'+(totalbsiva).toFixed(2)+' Bs </td><td style="width:35%;">'+(totalb).toFixed(2)+' Bs&nbsp</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> IVA </td><td style="width:15%;"></td><td style="width:35%;">'+(totalb-totalbsiva).toFixed(2)+' Bs </td><td style="width:35%;">'+''+'</td></tr></table>';
//texto+='<table width="100%"><tr align="right"><td style="width:20%;"> </td><td style="width:20%;"></td><td style="width:30%;">'+(totalbsiva).toFixed(2)+' Bs </td><td style="width:30%;">'+(totalb).toFixed(2)+' Bs&nbsp</td></tr></table>';

Ftexto+='S/IVA: '+(totalbsiva).toFixed(2)+'Bs C/IVA: '+(totalb).toFixed(2)+' Bs \n'
Ftexto+='IVA: '+(totalb-totalbsiva).toFixed(2)+'Bs\n';
}
console.log(Ftexto);




var TM="";
if (tipo==0) {TM="$";} else {TM="Bs";}

var textoT='<div style="position: fixed; text-align:right;background-color: gray;width:100%;">';
textoT+='<button style="font-size: 0.9em;" title="Cambia moneda" id="tipo_factura" onclick="cambia_moneda();">' + TM + '</button>&nbsp<button style="font-size: 0.9em;" title="Compartir" id="btnc" onclick="compartir();"> C </button> <button  style="font-size: 0.9em;" title="Salir" onclick="quitar();" > x </button></div><br>';
divfactura=document.getElementById("factura")
divfactura.style="position: fixed;top :35px; left: 2px; overflow-y: auto; width: 100% ; height: 80%; background-color: lightgray;color:white; border: 3px solid #73AD21;";
textoT+='<div style="color:black; font-size:0.8em;">'+texto+'</div>';
divfactura.innerHTML=textoT;
divfactura.hidden=false;
console.log("contador: "+contador);
document.getElementById("contad").innerText=contador+ " Productos";
}

var tipo=0;
var tipo2=0;
function cambia_moneda(){
tipo=1-tipo;
factura2();
}

function cambia_moneda2(){
tipo2=1-tipo2;
factura3();
}

function compartir(){
const shareData = {
  title: 'Factura',
  text: Ftexto
}
//console.log(shareData);
comparte(shareData);
}

async function comparte(shareData){
  try {
    await navigator.share(shareData)
    console.log('MDN shared successfully');
  } catch(err) {
    console.log( 'Error: ' + err);
  }
}


function anula(){

for (var i=0;i<data.length;i++){
data[i][4]=0;
data[i][5]=0;
}
if (document.getElementById("factura").hidden==false) {factura2();}
}

function quitar(){
var div5 = document.getElementById("factura");
div5.hidden=true;
factflag=true;
}
function precio(ind){
var factor=parseFloat(document.getElementById("t2").value);
if (data[ind][6]=="t1") {
 var pu=+(data[ind][2]*(1/factor)).toFixed(2);
 var pb=+(pu*data[ind][1]);
} 
if (data[ind][6]=="t2") {
   var pu=+(data[ind][2]).toFixed(2);
   var pb=+(pu*data[ind][1]);
    } 
if (data[ind][6]=="t3") {
   var pb=+(data[ind][2].toFixed(2));
   var pu=+((pb/data[ind][1]).toFixed(2));
    }

pu=parseFloat(pu.toFixed(2));
pb=parseFloat(pb.toFixed(2));
console.log('pu'+pu);
return [pu,pb];
}


function refresca2(){
var patron=document.getElementById("search").value.toUpperCase();
var pb;
var pu;
//t1=document.getElementById("t1").value;
t2=document.getElementById("t2").value;
//localStorage.setItem('p1',t1);
localStorage.setItem('p2',t2);
texto="";
var factor;
var fm;
var pu,pb;
for (var i=0;i<data.length;i++){
if (data[i][0].toUpperCase().indexOf(patron) !=-1)   {
if (data[i][6]=="t1") {factor=t2;}
if (data[i][6]=="t2") {factor=t2;}
//console.log(i+" "+data[i][0]);
texto+='<p  >'+ data[i][0]+'</p>';
console.log(data[i][0]+' ' +(data[i][2]).toFixed(2));
if (data[i][4]==0) {var vcor='black';} else {var vcor='blue';}
if (data[i][5]==0) {var vcor1='black';} else {var vcor1='blue';}
if (data[i][3]==1) {fm=1.16} else {fm=1}
//var pu=+(fm*data[i][2]/data[i][1]).toFixed(2);
//var pb=+(fm*data[i][2]).toFixed(2);
/*if (data[i][6]=="t1") {
  var pu=+(fm*data[i][2]*(1/t2)).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
} 
if (data[i][6]=="t2") {
  var pu=+(fm*data[i][2]).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
}

if (data[i][6]=="t3") {
  var pb=+(fm*data[i][2]).toFixed(2);
  var pu=+(pb/data[i][1]).toFixed(2);
}
*/
[pu,pb]=precio(i);
if (data[i][6]=="t1") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (fm*data[i][2]).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (fm*data[i][2]*data[i][1]).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
} 
if (data[i][6]=="t2") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (pu*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (pb*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
}
  
if (data[i][6]=="t3") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (pu*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (pb*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
}


 if (data[i][3]==1) {
    texto+="<span style='font-size:0.6em;'>Retenci&oacute;n T: "+(fm*data[i][2]/fiva).toFixed(2)+ " $ "+(fm*data[i][2]*factor/fiva).toFixed(2)+" Bs          </span>";
   }
}
}
texto+='<br><br>'
divt.innerHTML=texto;
}
function preciou(i){
var fm
if (data[i][3]==1) {fm=1.16} else {fm=1}
if (data[i][6]=="t1") {
  var pu=+(fm*data[i][2]*(1/t2)).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
} 
if (data[i][6]=="t2") {
  var pu=+(fm*data[i][2]).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
}

if (data[i][6]=="t3") {
  var pb=+(fm*data[i][2]).toFixed(2);
  var pu=+(pb/data[i][1]).toFixed(2);
}
return pu;
}

function preciob(i){
var fm
if (data[i][3]==1) {fm=1.16} else {fm=1}

if (data[i][6]=="t1") {
  var pu=+(fm*data[i][2]*(1/t2)).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
} 
if (data[i][6]=="t2") {
  var pu=+(fm*data[i][2]).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
}

if (data[i][6]=="t3") {
  var pb=+(fm*data[i][2]).toFixed(2);
  var pu=+(pb/data[i][1]).toFixed(2);
}
return pb;
}
function quitar_intro(){
document.getElementById("introd").style.visibility="hidden";
}

function cambiaU(num){
data[num][4]=document.getElementById("entradaU").value;
intro(num);
}
function cambiaB(num){
data[num][5]=document.getElementById("entradaB").value;
intro(num);
}
function cintro(num){
document.getElementById("factura").hidden=true;
factflag=true;
intro(num);
}

function intro(i){
var totalsivabs;
var totalsivad;
var fm;
var factor=parseFloat(document.getElementById("t2").value);
var BanderaIva;
var colb="black";
if (data[i][3]==1) {fm=1.16;BanderaIva="C/IVA";colb="black";} else {fm=1;BanderaIva="S/IVA";colb="blue";}
var divintro=document.getElementById("introd");
if (data[i][4]==0) {var vcor='red';} else {var vcor='blue';}
if (data[i][5]==0) {var vcor1='red';} else {var vcor1='blue';}
var pu=preciou(i);
var pb=preciob(i);

var texto='<table width="100%" style="background-color:'+colb+';color:white;"><tr ><td >'+data[i][0]+' '+BanderaIva+'</td><td style="text-align:left;"><button onclick="quitar_intro();">x</button></td></tr></table>';
if (data[i][6]=="t1") 
{
tex1='U '+(pu).toFixed(2)+' $';
tex2=(fm*data[i][2]).toFixed(2)+ ' Bs';
tex3='C '+(pb).toFixed(2)+' $';
tex4=(fm*data[i][2]*data[i][1]).toFixed(2)+ ' Bs';
} 
if (data[i][6]=="t2") 
{
tex1='U '+(pu).toFixed(2)+' $';
tex2=(pu*factor).toFixed(2)+ ' Bs';
tex3='C '+(pb).toFixed(2)+' $';
tex4=(pb*factor).toFixed(2)+ ' Bs';
}
  
if (data[i][6]=="t3") 
{
tex1='U '+(pu).toFixed(2)+' $';
tex2=(pu*factor).toFixed(2)+ ' Bs';
tex3='C '+(pb).toFixed(2)+' $';
tex4=(pb*factor).toFixed(2)+ ' Bs';
}
if (data[i][4]==0) {var valoru="";} else {var valoru=data[i][4];}
if (data[i][5]==0) {var valorb="";} else {var valorb=data[i][5];}

texto+='<table><tr><td>'+tex1+'</td><td>'+tex2+'</td><td><input id="entradaU" type="number" class="btn2" style="color:'+vcor+';" value="'+valoru+'" onchange="cambiaU('+i+');"></td></tr>';
texto+='<tr><td>'+tex3+'</td><td>'+tex4+'</td><td><input id="entradaB" type="number" class="btn2" style="color:'+vcor+';" value="'+valorb+'" onchange="cambiaB('+i+');"></td></tr></table>';


totalsivad=((pu)*data[i][4]+(pb)*data[i][5])/fm;
totalsivabs=totalsivad*factor;

 texto+='<table width="100%"><tr><td>Total S/IVA</td><td style="text-align:right;">'+(totalsivad).toFixed(2)+'</td><td style="color:blue:">$</td><td style="text-align:right;">'+(totalsivabs).toFixed(2)+'</td><td>Bs</td></tr>';
 texto+='<tr><td>Total C/IVA</td><td style="text-align:right;">'+(totalsivad*fm).toFixed(2)+'</td><td>$</td><td style="text-align:right;">'+(totalsivabs*fm).toFixed(2)+'</td><td>Bs</td></tr>';
 texto+='<tr><td>Diferencia IVA</td><td style="text-align:right;">'+(totalsivad*(fm-1)).toFixed(2)+'</td><td>$</td><td style="text-align:right;">'+(totalsivabs*(fm-1)).toFixed(2)+'</td><td>Bs</td></tr>';
 
texto+='</table>';
// if (data[i][3]==1) {
//    texto+="<span style='font-size:0.6em;'>Retenci&oacute;n T: "+(fm*data[i][2]/fiva).toFixed(2)+ " $ "+(fm*data[i][2]*factor/fiva).toFixed(2)+" Bs          </span>";
//   }

//texto+='U:'+pu+'<br>';
//texto+='B:'+pb+'<br>';


divintro.innerHTML=texto;
divintro.style.visibility = "visible";
console.log('num '+i);
console.log(divintro);
}

function refresca(){
//var patron=document.getElementById("search").value.toUpperCase();
var pb;
var pu;
//t1=document.getElementById("t1").value;
t2=document.getElementById("t2").value;
//localStorage.setItem('p1',t1);
localStorage.setItem('p2',t2);
texto="";
var factor;
var fm;
var cat_comp='&';
for (var i=1;i<Stack_cat.length;i++) {
 cat_comp+=Stack_cat[i]+'&';
}
var hay=false;
for (var i=0;i<data.length;i++){
//if (data[i][0].toUpperCase().indexOf(patron) !=-1) 
//console.log(i + " " +data[i][7]);  
//if (data[i][7].indexOf(cat_comp) !=-1) 

if ((data[i][7]==cat_comp) && (data[i][8]==1))  
{
console.log(data[i][8]);
hay=true;
if (data[i][6]=="t1") {factor=t2;}
if (data[i][6]=="t2") {factor=t2;}
//console.log(i+" "+data[i][0]);
texto+='<button class="bot4" onclick="intro('+i+');">'+ data[i][0]+'</button><br>';
console.log(data[i][0]+' ' +(data[i][2]).toFixed(2));
/*if (data[i][4]==0) {var vcor='black';} else {var vcor='blue';}
if (data[i][5]==0) {var vcor1='black';} else {var vcor1='blue';}
if (data[i][3]==1) {fm=1.16} else {fm=1}
//var pu=+(fm*data[i][2]/data[i][1]).toFixed(2);
//var pb=+(fm*data[i][2]).toFixed(2);


if (data[i][6]=="t1") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (fm*data[i][2]).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (fm*data[i][2]*data[i][1]).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
} 
if (data[i][6]=="t2") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (pu*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (pb*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
}
  
if (data[i][6]=="t3") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (pu*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (pb*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
}


 if (data[i][3]==1) {
    texto+="<span style='font-size:0.6em;'>Retenci&oacute;n T: "+(fm*data[i][2]/fiva).toFixed(2)+ " $ "+(fm*data[i][2]*factor/fiva).toFixed(2)+" Bs          </span>";
   }
*/
}

}
texto+='<br><br>'
divt.innerHTML=texto;
if (!hay) {
   document.getElementById("introd").style.visibility = "hidden";}
   else {
   document.getElementById("cat").style.visibility = "hidden";
}
}

function impri(A){
var At=A.toString();
var p=At.indexOf('.');
var num=At.substring(0,p);
var dec=At.substring(p+1,At.length);
//console.log(p+" "+num+" "+dec);
var B="";
var j=0;
var indfin=num.length
var porc=[];
while (indfin>0) {
porc[j]=num.substring(indfin-3,indfin);
indfin=indfin-3;
j=j+1;
}

for(var j=porc.length-1;j>0;j--)
{
B=B+porc[j]+".";
}
B=B+porc[0]+","+dec
//console.log(B);
return B;
}
impri(12356.3478);

</script>
<script>

// Registra el service worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('sw.js').then(function(registration) {
      // Si es exitoso
      console.log('SW registrado correctamente');
    }, function(err) {
      // Si falla
      console.log('SW fallo', err);
    });
  });
}
Act_data();

function Act_data(){
var myHeaders = new Headers();

var myInit = { mode: 'cors' };

//var nombrepag="https://monitordolarvenezuela.com/monitor-dolar-hoy";
var nombrepag="https://bdeabreu66.github.io/factura/precios.txt";


fetch(nombrepag,myInit)
        .then(ajaxPositive)
        .catch(showError);

function ajaxPositive(response) {
      console.log('response.ok: ', response.ok);
      if(response.ok) {
        response.text().then(showResult);
      } else {
        showError('status code: ' + response.status);
      }
    }
 function showResult(txt) {
        //console.log('muestro respuesta: ', txt);
        localStorage.setItem('data',txt);
        data=eval(txt);
        set_clave_indice();
        set_cat();
        muestra_cat();
        inicio_inventario();
        refresca();
        recupera_pedido("Pedido");
  }

function showError(err) { 
      console.log('muestor error', err);
    }
}

function Actualiza_dolar(){
var nomb="https://s3.amazonaws.com/dolartoday/data.json"
//var myHeaders = new Headers();
var myInit = { mode: 'cors' };

fetch(nomb,myInit)
        .then(ajaxPositiveD)
        .catch(showErrorD);

function ajaxPositiveD(response) {
      console.log('response.ok: ', response.ok);
      if(response.ok) {
        response.json().then(showResultD);
      } else {
        showErrorD('status code: ' + response.status);
      }
    }
 function showResultD(txt) {
       console.log('muestro respuesta: ', txt.USD.sicad2);
       //document.getElementById("t1").value = txt.USD.promedio;
       document.getElementById("t2").value = txt.USD.sicad2;
       refresca();
  }

function showErrorD(err) { 
      console.log('muestor error', err);
    }
}

Fecha_precios();

//descarga_historico();
function descarga_historico(){
var nomb="https://bdeabreu66.github.io/historico/historico.txt";
//var myHeaders = new Headers();
var myInit = { mode: 'cors' };
fetch(nomb,myInit)
        .then(ajaxPositiveD)
        .catch(showErrorD);

function ajaxPositiveD(response) {
      console.log('response.ok: ', response.ok);
      if(response.ok) {
        response.json().then(showResultD);
      } else {
        showErrorD('status code: ' + response.status);
      }
    }
 function showResultD(txt) {
       console.log('muestro respuesta: ', txt);
        Historico=txt;
        var ind=Historico.findIndex(elemento => elemento.fecha==fecha_actual());
        if (ind>=0) { document.getElementById("t2").value =Historico[ind].bcv};
    }
function showErrorD(err) {
 console.log('muestor error', err); 
  }
 
  

}

function Fecha_precios(){
var nomb="https://bdeabreu66.github.io/factura/fecha.txt";


//var myHeaders = new Headers();
var myInit = { mode: 'cors' };

fetch(nomb,myInit)
        .then(ajaxPositiveD)
        .catch(showErrorD);

function ajaxPositiveD(response) {
      console.log('response.ok: ', response.ok);
      if(response.ok) {
        response.json().then(showResultD);
      } else {
        showErrorD('status code: ' + response.status);
      }
    }
 function showResultD(txt) {
       console.log('fecha: '+ txt.dia+txt.mes+txt.ano);
      // document.getElementById("t1").value = txt.USD.promedio;
     //    document.getElementById("t2").value = txt.USD.sicad2;
      var fecha='('+txt.dia+'/'+txt.mes+'/'+txt.ano+')';
      document.getElementById("fecha_p").innerText=fecha;
      localStorage.setItem('FECHA_P',fecha);
  //  refresca();
  }

function showErrorD(err) { 
      console.log('muestor error', err);
    }

}


</script>
</BODY>
</html>