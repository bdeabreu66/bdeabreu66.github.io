<HTML>
<HEAD>
<TITLE>  Facturacion Polar</TITLE>
<!-- <link rel="stylesheet" href="styles.css" > -->
<link rel="manifest" href="manifest.json"> 

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
<style>

body{
font-size:30px;
}
input[type=number]{
width: 3em;
}


.btop{
font-size:1em;
}

.bot3:hover {
  background-color: #4CAF50; /* Green */
  color: blue;
}
.bot3{
transition-duration: 0.4s;
background-color: #4CAF50; /* Green */
padding:15px;
font-size:1.5em;
width:70%;
}

.bot4:hover {
  background-color: #4CAF50; /* Green */
  color: white;
}
.bot4{
background-color: #4CAF50; /* Green */
transition-duration: 0.4s;
padding:15px;
font-size:1.0em;
width:70%;
}
.btn2{
font-size:1em;
}


#dsearch {
position:relative;
}

#enc {
position:relative;
}
.nav {
font-size:2em;

}
#divt {
top:35%;
left:0%;
height: 60%;
text-align:center;
width:95%;
overflow-y:auto;
}

input[type=text]{
font-size:1em;
width: 4em;
border: 2px solid red;
border-radius: 4px;
padding: 4px 4px;
  margin: 4px 0;
  box-sizing: border-box;
  background-color: #3CBC8D;
  color: white;
}

input[type=text]:focus {
  background-color: lightblue;
}

p{
font-size:1.5rem;
background-color:black;
color:white;
padding:0px;
margin:0px;

}
td{
font-size:1.5rem;
padding:1px;
}
table{
margin:0px;
padding:0px;

}

#cat {
position:fixed;
top:35%;
left:0px;
height: 60%;
font-size:1.5rem;
text-align:center;
width:95%;
overflow-y:scroll;
}

#introd {
position:fixed;
background-color:green;
top:30%;
left:0%;
height: 40%;
width:98%;
overflow-y:scroll;
}

#footer {
  display: none;
  position: fixed;
  left: 0;
  bottom: 0;
  width: 100%;
  background-color: blue;
  color: white;
  text-align: center;
  font-size:0.5em;
}

#header {
  position: fixed;
  left: 0;
  top: 0;
  height=5%;
  width: 100%;
  background-color: blue;
  color: white;
  text-align: center;
  font-size:0.5em;
}

#cliente {
  position: fixed;
  left: 0;
  top: 5%;
  height=10%;
   width: 100%;
  background-color: black;
  color: red;
  text-align: left;
  font-size:0.8em;
}

.dolar {
 // position: fixed;
 // left: 0;
 // top: 50px;
  width: 100%;
  }
.cont0{


}
.cont1 {
display:grid;


grid-template-columns: 80% 20%;
border-bottom:1px solid black;
}

.conth1 {
grid-columns: 1/2;
}
.conth2 {
grid-columns: 2/3;
}


</style>

</HEAD>


<BODY onload="carga();" onunload="salir();">

<br>

<div class="dolar">
<table width="100%">
<tr><td>Paralelo </td><td><input id="t1" type="text" value="0"></td>
<td>BCV </td><td><input id="t2" type="text" value="0"></td></tr>
<!--<div id="menu"></div> -->
<!-- <tr><td><input id="t3" onchange="camb();" type="checkbox" value="Automatico"><label for="t3"> Automatico </label></td></tr> -->
</table>
</div>
<div class="cont0">
<div class="cont1">
<div class="con1h1">
<center>Facturaci&oacute;n <br><span id="fecha_p" style="font-size:1em;"></span></center>
</div>
<div class="con1h2">
<button class="nav" onclick="sube_cat()";>&#8630;</button>
</div>
</div>
</div>
<div id="arbol"></div>
<div id="cat" ></div>
<!-- <div id="dsearch"> <input id="search" type="text" placeholder="Buscar" oninput="refresca();"></div>-->
<div id="divt" ></div>
<div id="introd" ></div>
<div id="content" hidden="false"></div>
<div id="factura" hidden="true">

</div>
 <div id="footer"> Dr. Braulio De Abreu. email: brauliodeabreu@gmail.com <br> Tlfs: +58414 4728631 +58412 8552592</div>
 <div id="header">
<table width="100%">
<tr align="center">
<td width="25%"> <button class="btop" onclick="Actualiza_cliente();">C</button></td>
<td width="25%"><button class="btop" onclick="Actualiza_dolar();">A</button></td>
<td width="25%"><button class="btop" onclick="factura();">F</button></td> 
<td width="25%"><button class="btop" onclick="anula();">Z</button></td>
</tr></table>
</div>
<div id="cliente" hidden="true">
Cliente: <input style="width:55%;" type="text" id="cli" value="" list="listaclientes">&nbsp&nbsp<button onclick="setcliente();">OK</button>&nbsp&nbsp<button onclick="elimina_cliente();">E</button>'
<datalist id="listaclientes"></datalist>
</div>

<!--   -->

<script src="arbol.js" type="text/javascript"></script>
<script type="text/javascript">
var cliente='';
var AClientes=[];
function elimina_cliente(){
var ecliente;
document.getElementById("cliente").hidden=true;
ecliente=document.getElementById("cli").value;
var pos=AClientes.indexOf(ecliente);
if (pos>=0) {AClientes.splice(pos,1);guarda_clientes();}


console.log('LC: '+Lclientes);
}


function setcliente(){
document.getElementById("cliente").hidden=true;
cliente=document.getElementById("cli").value;
if (document.getElementById("factura").hidden==false) {factura2();}
console.log('LC: '+Lclientes);
console.log('C: '+cliente);
console.log('Lo: '+AClientes.length);
console.log(AClientes.indexOf(cliente));
if (AClientes.indexOf(cliente)==-1) {AClientes.push(cliente);guarda_clientes();}
console.log('LC: '+Lclientes);
}


function Actualiza_cliente(){
Lee_clientes();
divcliente=document.getElementById("cliente");
document.getElementById("cliente").value=cliente;
//divcliente.innerHTML=texto;
divcliente.hidden=false;

}


function guarda_clientes(){
var Lclientes='';
for (var i = 0; i < AClientes.length; i++){
Lclientes+='&'+AClientes[i];
}
console.log('LC: '+Lclientes);
if (Lclientes.length>0) {localStorage.setItem('Clientes',Lclientes.substr(1));}
   else 
{localStorage.setItem('Clientes','');}

}


function Lee_clientes(){
Lclientes=localStorage.getItem('Clientes');
if (Lclientes!='' && Lclientes!=null) {
AClientes=Lclientes.split('&');
var options='';
for (var i = 0; i < AClientes.length; i++) {
  options += '<option value="' + AClientes[i] + '" />';
}

console.log('op'+options)
document.getElementById('listaclientes').innerHTML = options;
}
}

function guarda_pedido(){
var texto='';
for (var i=0;i<data.length;i++) {
if ((data[i][4]!=0) || (data[i][5]!=0)) { 
 texto+='&'+i+'#'+data[i][4]+'#'+data[i][5];
}
if (texto.length>2) {localStorage.setItem('Pedido',texto.substr(1));} else {localStorage.setItem('Pedido','');}
} 
localStorage.setItem('Cliente',cliente);
}

function recupera_pedido(){
var texto;
cliente=localStorage.getItem('Cliente');
texto=localStorage.getItem('Pedido');
if (texto!='') {
var ped=texto.split('&');
console.log('texto: '+texto.length);
console.log(ped.length);
for (var i=0;i<ped.length;i++) {
  var items=ped[i].split('#');
  var ind=parseInt(items[0]);
  data[ind][4]=parseInt(items[1]);
  data[ind][5]=parseInt(items[2]);
}
}

}

function salir(){
guarda_pedido();
t1=document.getElementById("t1").value;
t2=document.getElementById("t2").value;
localStorage.setItem('p1',t1);
localStorage.setItem('p2',t2);
}
var lcat=[];
var Stack_cat=['Tienda'];
var Cats;
var cat_actual='Tienda';
var cat_ant='';

function set_cat(){
Cats = new Tree();
Cats.add('Tienda','');
var categorias=[];
var ldatos=data.length;
for (i=0;i<ldatos;i++){
console.log(data[i][8]);
 if (data[i][8]==1) {
  if  (!categorias.includes(data[i][7])) {
     categorias.push(data[i][7]);   
  } 
 }
}
var categ;
var nrocateg;
var ldatos2=categorias.length;
console.log(ldatos2);
for (i=0;i<ldatos2;i++){
  categ=categorias[i].split('&');
  nrocateg=categ.length-2;
  console.log(i + ' '+categ[1]+ ' '+ nrocateg);
  Cats.add(categ[1],'Tienda');
  for (var j=2;j<=nrocateg;j++) {
     console.log('subc '+ j+ ' '+categ[j]);
     Cats.add(categ[j],categ[j-1]);
   }
}

console.log(Cats);
}



function muestra_cat(){
var divcat=document.getElementById("cat");
var divarbol=document.getElementById("arbol");
cat_actual=Stack_cat[Stack_cat.length-1];
var text_cat='';
for (i=0;i<Stack_cat.length;i++)
    text_cat+=Stack_cat[i]+'/';
var nodo=Cats.findBFS(cat_actual) ;
var texto='';
texto+='<center>'+text_cat+'</center>';
if (Stack_cat.length>1) {
//texto+='  '+'<button class="nav" onclick="sube_cat()";>'+'&#9650'+'</button>'
}
//texto+='<br>';
divarbol.innerHTML=texto;
//cat_ant=cat_actual;
texto='';
for (i=0;i<nodo.children.length;i++){
  var aux=nodo.children[i].value;
  texto+='  '+'<button class="bot3" onclick="cambia_cat(\''+aux+'\')";>'+aux+'</button>';

}
divcat.innerHTML=texto;
divcat.style.visibility="visible";

//divcat.hidden=false;

}
function sube_cat(){
if (Stack_cat.length>1) { 
 Stack_cat.pop();
 muestra_cat();
refresca();
console.log('paso sube');
}
}

function cambia_cat(valor){
Stack_cat.push(valor)
cat_ant=cat_actual;
console.log('cat anterior  '+cat_ant);
cat_actual=valor.toString();
muestra_cat();
refresca();
console.log('paso');
}

function ordena(){
data.sort(function(a, b){
  if (a.cat<b.cat) {return -1} else {return 0;}
   });
}

var dist="Distribuidora Pita-Orozco"
var hoy=new Date();
function camb(){
var va=document.getElementById("t3").checked; 
console.log('va '+va);
localStorage.setItem('p3',va);
}
function carga(){
data=[];

try {
document.getElementById("t1").value = localStorage.getItem('p1');
document.getElementById("t2").value = localStorage.getItem('p2');
document.getElementById("fecha_p").innerText = localStorage.getItem('FECHA_P');
//document.getElementById("t3").checked = localStorage.getItem('p3');
} catch (error) 
{
  console.error(error);

}

try {
data=eval(localStorage.getItem('data'));

} catch (error) 
{
  console.log(error);

}



//var fecha=document.getElementById("fecha");
//fecha.innerHTML="V 0.1 13/10/2021";
divt=document.getElementById("divt");
fiva=7.25;

var j=0;


data= [["Vacio de cerveza Ret 222 ml x 36 UN",1,63,0,0,0,"t1","&Cerveceria&Vacios&",1],
      ["Vacio de cerveza Ret 330 ml x 24 UN",1,63,0,0,0,"t1","&Cerveceria&Vacios&",1],
      ["Gavera de cerveza Ret 222 ml x 36 UN",1,12,60,0,0,"t1","&Cerveceria&Vacios&",1],
      ["Gavera de cerveza Ret 333 ml x 24 UN",1,12,60,0,0,"t1","&Cerveceria&Vacios&",1],
      ["Botella de cerveza Ret 222 ml ",1,1.40,0,0,0,"t1","&Cerveceria&Vacios&",1],
      ["Botella de cerveza Ret 333 ml ",1,2.10,0,0,0,"t1","&Cerveceria&Vacios&",1],
      ["Barril 30 lt ",1,860,0,0,0,"t1","&Cerveceria&Vacios&",1],
      ["Barril 50 lt ",1,970,0,0,0,"t1","&Cerveceria&Vacios&",1],
      ["F01001 Pilsen Ret 222 ml x 36 UN",36,16.79,0,0,0,"t3","&Cerveceria&Pilsen&",1],
      ["F01002 Pilsen Ret 330 ml x 24 UN",24,16.79,0,0,0,"t3","&Cerveceria&Pilsen&",1],
      ["F01063 Pilsen NR 355 ml x 12 UN",12,11.52,0,0,0,"t3","&Cerveceria&Pilsen&",1],
      ["F01077 Pilsen lata Sleek 355 ml x 12 UN",12,9.60,0,0,0,"t3","&Cerveceria&Pilsen&",1],   
      ["F03014 Solera Light Ret 222 ml x 36 UN",36,19.20,0,0,0,"t3","&Cerveceria&Solera&Retornable&",1],
      ["F03030 Solera Ret 222 ml x 36 UN",36,19.20,0,0,0,"t3","&Cerveceria&Solera&Retornable&",1],
      ["F03076 Solera NR 222 ml x 12 UN",12,8.17,0,0,0,"t3","&Cerveceria&Solera&NR&",1],
      ["F03077 Solera Light NR 222 ml x 12 UN",12,8.17,0,0,0,"t3","&Cerveceria&Solera&NR&",1],
      ["F04005 Polar Light Ret 222 ml x 36 UN",36,16.79,0,0,0,"t3","&Cerveceria&Light&",1],
      ["F04017 Polar Light Barril 30L x 1 PZ",1,71.01,0,0,0,"t3","&Cerveceria&Light&",1],
      ["F04018 Polar Light Barril 50L x 1 PZ",1,118.01,0,0,0,"t3","&Cerveceria&Light&",1],
      ["F04043 Light NR 355 ml x 12 UN",12,11.52,0,0,0,"t3","&Cerveceria&Light&",1],   
      ["F04052 Light Mix Naranja NR 355 ml x 12 UN",12,11.52,0,0,0,"t3","&Cerveceria&Light&",1],
      ["F04053 Light Mix Toronja NR 355 ml x 12 UN",12,11.52,0,0,0,"t3","&Cerveceria&Light&",1],
      ["F04054 Light Mix Parchita NR 355 ml x 12 UN",12,11.52,0,0,0,"t3","&Cerveceria&Light&",1],
      ["F04056 Light Lata Sleek 355 ml x 12 UN",12,9.60,0,0,0,"t3","&Cerveceria&Light&",1],
      ["F06034 Solera Marzen  Ret 222 ml x 36 UN",36,19.20,0,0,0,"t3","&Cerveceria&Solera&Retornable&",1],
      ["F06037 Solera IPA Ret 222 ml x 36 UN",36,19.20,0,0,0,"t3","&Cerveceria&Solera&Retornable&",1],
      ["F06046 Solera Kriek Ret 222 ml x 36 UN",36,19.20,0,0,0,"t3","&Cerveceria&Solera&Retornable&",1],
      ["F05056 Solera Marzen NR 222 ml x 12 UN",12,8.17,0,0,0,"t3","&Cerveceria&Solera&NR&",1],
      ["F06057 Solera IPA NR 222 ml x 12 UN",12,8.17,0,0,0,"t3","&Cerveceria&Solera&NR&",1],
      ["F06058 Solera Kriek NR 222 ml x 12 UN",12,8.17,0,0,0,"t3","&Cerveceria&Solera&NR&",1],
      ["F06059 Solera Reserva Ret 222 ml x 36 UN",36,19.20,0,0,0,"t3","&Cerveceria&Solera&NR&",1],
      ["F06060 Solera Kriek NR 222 ml x 12 UN",12,8.17,0,0,0,"t3","&Cerveceria&Solera&NR&",1],
      ["FR0123 Carorena tinta 6 unid",6,39.85,0,0,0,"t3","&Cerveceria&Sangria&",1],
      ["FR0120 Carorena blanca 6 unid",6,39.85,0,0,0,"t3","&Cerveceria&Sangria&",1],
      ["FR0123 Carorena rosada 6 unid",6,39.85,0,0,0,"t3","&Cerveceria&Sangria&",1],
      ["FR0133 Carorena verano x 36",36,33.60,0,0,0,"t3","&Cerveceria&Sangria&",1],
      ["F07001 Maltin polar ret 222 ml x 36 U",36,12.97,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["F07003 Maltin Nr.250 ml x 24 U",24,0.00,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["F07018 Maltin 1.5 L x 6U",6,13.54,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["F07020 Maltin Nr/Light.250 ml x 24 U",24,0.00,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["F07073 Maltin light 1.5 L x 6U",6,13.54,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["F07086 Maltin polar light ret 222 ml x 36 U",36,12.97,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["F07088 Maltin light Nr.250 ml x 12 U",12,7.34,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["F07089 Maltin Nr.250 ml x 12 U",12,7.34,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["F07090 Malta Caracas NR 250 ml x 12 U",12,7.34,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["F07101 Maltin polar sleek 355 ml x 24 U",24,17.49,0,0,0,"t3","&Cerveceria&Malta&",1],
      ["H201 Aceite Mazeite 1 lt x 12",12,4.59,0,0,0,"t2","&Alimentos&Aceites&",1],
      ["M324 Dogourmet Parrilla. 18 Kg x 1U",1,38.36,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1],      
      ["M326 Dogourmet Parrilla. 2 Kg x 6U",6,5.73,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1],
      ["M329 Dogourmet Cachorros 18 Kg x 1",1,43.19,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1],
      ["M330 Dogourmet Cachorros 2 Kg x 6U",6,6.29,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1],
      ["M338 Dogourmet Parrilla. 4 Kg x 5U",5,9.95,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1],
      ["M340 Super Can.carne hueso 4 Kg x 5U",5,7.47,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1],
      ["M033 Super Can.carne hueso 18 Kg x 1",1,28.91,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1],
      ["M034 Super Can. pollo 18 Kg x 1",1,28.91,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1],
      ["M347 Dogourmet Parrilla. 1 Kg x 10U",10,3.02,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1],
      ["M800 Super Can. carne hueso 2 Kg x 6U",6,3.80,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1],
      ["M802 Super Can.carne hueso 10 Kg x 1",1,16.90,1,0,0,"t2","&Alimentos&A. Perros&Super Can&",1],
      ["M803 Dogourmet Cachorros 10 Kg x 1U ",1,24.05,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1],
      ["M806 Dogourmet Parrilla. 10 Kg x 1U",1,21.89,1,0,0,"t2","&Alimentos&A. Perros&Dogourmet&",1],
      ["H300 Arroz Clasico. 1 Kg x 24 ",24,1.25,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Arroz&",1],
      ["H364 Arroz Corina. 1 Kg x 24 ",24,1.02,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Arroz&",1],
      ["D361 Margarita Atun natural 140g x 35",35,1.77,1,0,0,"t2","&Alimentos&Enlatados&Atun&",1],
      ["D362 Margarita Atun en aceite 140g x 35",35,1.69,1,0,0,"t2","&Alimentos&Enlatados&Atun&",1],
      ["Q001 Avena Quaker Original (Bolsa) 400g x 24",24,1.56,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q002 Avena Quaker Original (Bolsa) 800g x 12",12,2.71,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q023 Harina Avena Quaker (Bolsa) 400g x 24",24,1.56,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q064 Avena fortificada 400g x 24",24,0.00,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q134 Avena Vainilla casera 400g x 24",24,1.56,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q135 Avena Sirop de Maple 400g x 24",24,1.56,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q136 Avena Orignal (Bolsa) 100g x 48",48,0.41,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q464 Avena fortificada 100g x 48",48,0.00,0,0,0,"t2","&Alimentos&Avena&",1],     
      ["Q465 Avena fortificada 200g x 30",30,0.00,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q005 Avena( Don Pancho) 400g x 24",24,1.23,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q006 Avena( Don Pancho) 800g x 12",12,2.14,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q137 Avena Orignal (Bolsa) 200g x 30",30,0.79,0,0,0,"t2","&Alimentos&Avena&",1],
      ["Q113 KONGA SABOR LIMON 30gx8x14",8,4.90,1,0,0,"t2","&Alimentos&Konga&",1],
      ["Q114 KONGA SABOR NARANJA 30gx8x14",8,4.90,1,0,0,"t2","&Alimentos&Konga&",1],
      ["Q115 KONGA SABOR MORA 30gx8x14 ",8,4.90,1,0,0,"t2","&Alimentos&Konga&",1],
      ["Q123 KONGA SABOR PARCHITA 30gx8x14",8,4.90,1,0,0,"t2","&Alimentos&Konga&",1],
      ["H172 Pan/Mezcla cachapas 500g x 12",12,1.53,1,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Cachapas&",1],
      ["H330 Primor Crema/Arroz Enriq 450g x 24 Pote",24,1.40,0,0,0,"t2","&Alimentos&Cereales I&",1],
      ["H331 Primor Crema/Arroz Enriq 900g x 12 Pote",12,2.22,0,0,0,"t2","&Alimentos&Cereales I&",1],
      ["H369 Primor Crema/Arroz (Bolsa) 225g x 34",34,0.62,0,0,0,"t2","&Alimentos&Cereales I&",1],
      ["H370 Crema/Arroz.(Bolsa) Enriq 450g x 24",24,1.07,0,0,0,"t2","&Alimentos&Cereales I&",1],
      ["H371 Crema/Arroz.(Bolsa) Enrriq( 900g x 12 Bolsa",12,1.70,0,0,0,"t2","&Alimentos&Cereales I&",1],
      ["Q099 Toddy. Chips Galleta (24gx6)x24 ",24,2.28,1,0,0,"t2","&Alimentos&Varios&Galletas&",1],
      ["Q138 Toddy. Chips Galleta (24gx4)x40 ",40,1.4,1,0,0,"t2","&Alimentos&Varios&Galletas&",1],
      ["Y065 Pudin Toddy. (125gx6)x24 ",24,0.67,1,0,0,"t2","&Alimentos&Varios&Pudin&",1],
      ["Q101 Gelatina Golden Fresa 96 gr x 10U",10,13.80,1,0,0,"t2","&Alimentos&Varios&Gelatinas&",1],
      ["Q102 Gelatina Golden Kolita 96 gr x 10U",10,13.80,1,0,0,"t2","&Alimentos&Varios&Gelatinas&",1],
      ["Q103 Gelatina Golden Uva 96 gr x 10U",10,13.80,1,0,0,"t2","&Alimentos&Varios&Gelatinas&",1],
      ["Q107 Gelatina Golden Frambuesa 96 gr x 10U",10,13.80,1,0,0,"t2","&Alimentos&Varios&Gelatinas&",1],
      ["H135 Harina Pan tradicional 1 k x 20",20,1.28,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Harinas de Maiz&",1],
      ["H136 Harina Pan Amarilla k x 20",20,1.28,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Harinas de Maiz&",1],
      ["H173 Harina Pan/Arroz.1 k x 20",20,1.14,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Harinas de Maiz&",1],
      ["T060 Salsa/Tomate.198 x 24",24,0.88,1,0,0,"t2","&Alimentos&Ketchup&",1],
      ["T061 Salsa/Tomate.397 x 24",24,1.38,1,0,0,"t2","&Alimentos&Ketchup&",1],
      ["T449 Salsa/Tomate. 4,2 x 4",4 ,12.97,1,0,0,"t2","&Alimentos&Ketchup&",1],
      ["T076 Chef Margarina 5 K x 1.C/S",1,18.89,0,0,0,"t2","&Alimentos&Margarinas&Chef&",1],
      ["T080 Chef Margarina 5 K x 1.S/S",1,18.89,0,0,0,"t2","&Alimentos&Margarinas&Chef&",1],
      ["T084 Mantequilla Mavesa 1 K x 6",6,3.99,0,0,0,"t2","&Alimentos&Margarinas&Mavesa&",1],
      ["T086 Mantequilla Mavesa 500g x 12",12,2.05,0,0,0,"t2","&Alimentos&Margarinas&Mavesa&",1],
      ["T572 Mantequilla Mavesa 250g x 24",24,1.11,0,0,0,"t2","&Alimentos&Margarinas&Mavesa&",1],
      ["T578 Mantequilla Nelly CR 400g x 12",12,0.97,0,0,0,"t2","&Alimentos&Margarinas&Nelly&",1],
      ["T587 Mantequilla Nelly CR 250g x 24",24,0.97,0,0,0,"t2","&Alimentos&Margarinas&Nelly&",1],
      ["T588 Mantequilla Nelly CR 500g x 12",12,1.83,0,0,0,"t2","&Alimentos&Margarinas&Nelly&",1],
      ["T018 Mayonesa 910g x 6",6,6.51,0,0,0,"t2","&Alimentos&Mayonesas&",1],
      ["T019 Mayonesa 175g x 18",18,1.63,0,0,0,"t2","&Alimentos&Mayonesas&",1],
      ["T020 Mayonesa 445g x 12",12,3.46,0,0,0,"t2","&Alimentos&Mayonesas&",1],
      ["T393 Mayonesa 445g x 12 ND",12,3.46,0,0,0,"t2","&Alimentos&Mayonesas&",1],
      ["T486 Mayonesa(Aderezo) 3,6 kg x 4",4,23.79,1,0,0,"t2","&Alimentos&Mayonesas&",1],
      ["T409 Mayonesa  Stock 175g x 24 U",24,1.63,0,0,0,"t2","&Alimentos&Mayonesas&",1],
      ["T573 Mayonesa  Stock 175g x 24 U",24,1.63,0,0,0,"t2","&Alimentos&Mayonesas&",1],
      ["T574 Mayonesa limon  445 g x 12",12,3.46,0,0,0,"t2","&Alimentos&Mayonesas&",1],
      ["T001 Toddy. 1 Kg x 12U Bolsa",12,8.53,1,0,0,"t2","&Alimentos&Toddy&",1],
      ["T002 Toddy. 2 Kg x 8U. Bolsa",8,15.99,1,0,0,"t2","&Alimentos&Toddy&",1],
      ["T003 Toddy. 400g x 24U Bolsa",24,3.87,1,0,0,"t2","&Alimentos&Toddy&",1],
      ["T007 Toddy. 400g x 12U Pote",12,3.87,1,0,0,"t2","&Alimentos&Toddy&",1],
      ["T472 Toddy. 200g x 12U Pote",12,2.05,1,0,0,"t2","&Alimentos&Toddy&",1],
      ["T568 Toddy. 100g x 36U Bolsa",36,1.09,1,0,0,"t2","&Alimentos&Toddy&",1],
      ["T427 Aceite Chef Oleina de Palma.18 Lt x 1U",1,62.71,0,0,0,"t2","&Alimentos&Aceites&",1],
      ["T584 Aceite Super Oleina de Palma.1 Lt x 12U",12,2.98,0,0,0,"t2","&Alimentos&Aceites&",1],
      ["H500 Pasta corta dedales 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Corta&",1],
      ["H501 Pasta corta tornillo 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Corta&",1],
      ["H506 Pasta corta plumitas 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Corta&",1],
      ["H509 Pasta corta dedales 500g x 12U",12,0.91,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Corta&",1],
      ["H516 Pasta larga vermicelli 500g x 12U",12,0.91,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1],
      ["H517 Pasta larga spaguetti 500g x 12U",12,0.91,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1],
      ["H689 Pasta larga vermicelli 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1],
      ["H690 Pasta larga spaguetti 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1],
      ["H1804 Pasta larga Linguini. 1 K x 12U",12,1.79,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Larga&",1],
      ["H992 Primor especial vermicelli 1 K x 12U",12,1.51,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Especial&",1],
      ["H993 Primor especial plumitas 1 K x 12U",12,1.51,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Especial&",1],
      ["H992 Primor especial tornillos 1 K x 12U",12,1.51,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Especial&",1],
      ["H992 Primor especial dedales 1 K x 12U",12,1.51,0,0,0,"t2","&Alimentos&Arroz-Pasta-Harina&Pasta&Especial&",1],
      ["D366 Pepitonas picantes 140g x 35 ",35,1.35,1,0,0,"t2","&Alimentos&Enlatados&Pepitonas&",1],
      ["D388 Bonito en aceite 140g x 35",35,1.48,1,0,0,"t2","&Alimentos&Enlatados&Bonito&",1],
      ["T499 Rikesa Trad.200 x 18",18,2.28,1,0,0,"t2","&Alimentos&Rikesa&",1],
      ["T500 Rikesa Trad.300 x 12",12,3.29,1,0,0,"t2","&Alimentos&Rikesa&",1],
      ["T501 Rikesa Tocineta.300 x 12",12,3.29,1,0,0,"t2","&Alimentos&Rikesa&",1],
      ["T564 Rikesa Blanco.200g x 18U",18,2.28,1,0,0,"t2","&Alimentos&Rikesa&",1],
      ["T565 Rikesa Parmesano 200g x 18U",18,2.28,1,0,0,"t2","&Alimentos&Rikesa&",1],
      ["D384 Sardina Aceite.170 x 20",20,1.42,0,0,0,"t2","&Alimentos&Enlatados&Sardinas&",1],
      ["D385 Sardina Picante.170x 20",20,1.42,0,0,0,"t2","&Alimentos&Enlatados&Sardinas&",1],
      ["D386 Sardina Tomate.170x 20",20,1.42,0,0,0,"t2","&Alimentos&Enlatados&Sardinas&",1],
      ["T297 Mermelada Vienesa Fresa 240g x 18U",18,2.12,1,0,0,"t2","&Alimentos&Varios&Mermeladas&",1],
      ["T298 Mermelada Vienesa Guayaba 240g x 18U",18,2.12,1,0,0,"t2","&Alimentos&Varios&Mermeladas&",1],
      ["T583 Mermelada Vienesa Fresamora 240g x 18U",18,2.12,1,0,0,"t2","&Alimentos&Varios&Mermeladas&",1],
      ["T048 Vinagre. 1 lt x 12",12,1.31,1,0,0,"t2","&Alimentos&Vinagres&",1],
      ["T049 Vinagre. 1/2 lt x 24",24,0.78,1,0,0,"t2","&Alimentos&Vinagres&",1],
      ["T533 Vinagre. 4 lt x 4",4,5.18,1,0,0,"t2","&Alimentos&Vinagres&",1],
      ["D390 Primor Caraotas negras sazonadas 220gx24U",20,0.89,1,0,0,"t2","&Alimentos&Enlatados&Caraotas&",1],
      ["D391 Primor Frijoles sazonados 220gx24U",20,0.89,1,0,0,"t2","&Alimentos&Enlatados&Frijoles&",1],
      ["D392 Primor Caraotas negras sazonadas 220gx12U",12,1.67,1,0,0,"t2","&Alimentos&Enlatados&Caraotas&",1],
      ["D393 Primor Frijoles sazonados 220gx12U",12,1.67,1,0,0,"t2","&Alimentos&Enlatados&Frijoles&",1],
      ["Y001 Yogurt Fruta Fresa Migurt 125gx24",24,1.32,1,0,0,"t2","&Alimentos&Varios&Yogurt&",1],
      ["Y002 Yogurt Fruta Durazno Migurt 125 x 24",24,1.32,1,0,0,"t2","&Alimentos&Varios&Yogurt&",1],
      ["Y004 Yogurt Fruta Fresa Migurt 250 x 24",24,2.40,1,0,0,"t2","&Alimentos&Varios&Yogurt&",1],
      ["Y005 Yogurt Fruta durazno Migurt 250 x 24",24,2.40,1,0,0,"t2","&Alimentos&Varios&Yogurt&",1],
      ["Y007 Yogurt Fruta Fresa Migurt 750 x 12",12,5.94,1,0,0,"t2","&Alimentos&Varios&Yogurt&",1],
      ["Y008 Yogurt Fruta Durazno Migurt 750 x 12",12,5.94,1,0,0,"t2","&Alimentos&Varios&Yogurt&",1],
      ["Y009 Yogurt sabor dulce Migurt 750 x 12",12,5.94,1,0,0,"t2","&Alimentos&Varios&Yogurt&",1],
      ["Y036 Yogurt sabor fresa Migurt 125 x 24",24,1.27,1,0,0,"t2","&Alimentos&Varios&Yogurt&",1],
      ["L260 Las llaves Detergente Bebe 400g x 30",30,1.37,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L073 Las llaves Detergente P. LI 900g x 20",20,3.02,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L081 Las llaves Detergente Floral 400g x 30",20,1.37,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L082 Las llaves Detergente Floral 900g x 20",20,3.02,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L255 Las llaves Detergente Bebe 900g x 20",20,3.02,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L350 Las llaves Detergente liq.Bebe 1L x 12",12,5.64,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L367 Las llaves Detergente liq.ROPA DELI.510cc x 12",12,3.15,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L382 Multiclean Detergente Frag citrica 900g x 20",20,1.59,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L383 Multiclean Detergente Frag citrica 400g x 30U",30,0.73,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L384 Multiclean Detergente Frag citrica 5 Kg x 4U",4,8.79,1,0,0,"t2","&Alimentos&Limpieza&Detergentes&",1],
      ["L207 Llaves Panela Trad Floral 250 x 36",36,0.86,1,0,0,"t2","&Alimentos&Limpieza&Jabones&",1],
      ["L275 LLaves Jabon FF.BEBE.160 x 48U",48,0.71,1,0,0,"t2","&Alimentos&Limpieza&Jabones&",1],
      ["L376 Jabon Panela.Floral.200 x 44",44,0.71,1,0,0,"t2","&Alimentos&Limpieza&Jabones&",1],
      ["L389 Multi Clean jabon Frag citrica 200 g x 44U",44,0.48,1,0,0,"t2","&Alimentos&Limpieza&Jabones&",1],     
      ["L379 LLaves Lav. Antib liq. 500cc x 18U",18,3.01,1,0,0,"t2","&Alimentos&Limpieza&Lavaplatos&",1],
      ["L387 LLaves Lav. Antib liq. 500cc x 18U",18,3.01,1,0,0,"t2","&Alimentos&Limpieza&Lavaplatos&",1],     
      ["L371 LLaves Limp. Marea Cristalina 1L x 12",12,2.65,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",1],
      ["L372 LLaves Limp. Brisa Tropical 1L x 12",12,2.65,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",1],
      ["L377 LLaves Limp. Marea Cristalina 500cc  x 24",24,1.50,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",1],
      ["L378 LLaves Limp. Brisa Tropical 500cc x 24U",24,1.50,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",1],
      ["L385 Llaves Limp. Bosque sereno 500cc x 24U",24,1.50,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",1],
      ["L386 Llaves Limp. Bosque sereno 1 L x 12U",12,2.65,1,0,0,"t2","&Alimentos&Limpieza&Limpiadores&",1],
      ["L357 Jabon Crema Multiuso.250g x 36U",36,1.92,1,0,0,"t2","&Alimentos&Limpieza&Multiuso&",1],
      ["L358 Jabon Crema Multiuso.500g x 18U",18,3.49,1,0,0,"t2","&Alimentos&Limpieza&Multiuso&",1],
      ["L373 Jabon pastilla Multiuso 130g x 42U",42,1.00,1,0,0,"t2","&Alimentos&Limpieza&Multiuso&",1],
      ["L374 Las llaves Suavizante Bebe  950cc x 12U",12,4.00,1,0,0,"t2","&Alimentos&Limpieza&Suavizantes&",1],
      ["L380 Las llaves Suavizante Bebe 530cc x 12U",12,2.38,1,0,0,"t2","&Alimentos&Limpieza&Suavizantes&",1],
      ["PepsiCola 350 ml x 24",24,10.192,1,0,0,"t3","&Pepsicola&Pepsi&botella&",1],
      ["PepsiCola lata 355 ml x 24",24,21.23,1,0,0,"t3","&Pepsicola&Pepsi&Lata&",1],
      [" 1/4 PepsiCola lata 355 ml x 6",6,5.31,1,0,0,"t3","&Pepsicola&Pepsi&Lata&",1],
      [" PepsiCola lata 320 ml x 24",24,21.23,1,0,0,"t3","&Pepsicola&Pepsi&Lata&",1],
      [" 1/4 PepsiCola lata 320 ml x 6",6,5.31,1,0,0,"t3","&Pepsicola&Pepsi&Lata&",1],
      [" PepsiCola PET 600 ml x 12",12,7.54,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1],
      [" PepsiCola PET 1,5 L x 12",12,16.03,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1],
      [" PepsiCola MAX PET 1,5 L ml x 12",12,10.78,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1],
      [" PepsiCola PET 1,5 L x 6",6,8.02,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1],
      [" PepsiCola MAX PET 1,5 L  x 6",6,5.39,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1],
      [" PepsiCola PET 2 L  x 6",6,8.02,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1],
      [" PepsiCola MAX PET 2 L  x 6",6,7.19,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1],
      [" PepsiCola PET 1 L x 6",6,5.06,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1],
      [" PepsiCola PET 1,25 L x 6",6,4.83,1,0,0,"t3","&Pepsicola&Pepsi&PET&",1],
      [" PepsiCola PSH 250 ml x 24",24,17.65,1,0,0,"t3","&Pepsicola&Pepsi&PSH&",1],
      [" PepsiCola PSH 250 ml x 12",12,8.81,1,0,0,"t3","&Pepsicola&Pepsi&PSH&",1]
];
set_cat();
muestra_cat();
refresca();
}
function actT(ind){
var valor=prompt("Introduzca cantidad", "");
if (valor!=null) {data[ind][5]=parseInt(valor);}
intro(ind);

console.log(ind);
}
function actU(ind){
var valor=prompt("Introduzca cantidad", "");
if (valor!=null) {data[ind][4]=parseInt(valor);}
intro(ind);

console.log(ind);
}
var factflag=true;
function factura(){
if (factflag) {factflag=false; factura2(); } else { factflag=true; quitar()};

}
var Ftexto;

function fecha_actual(){
var mes=(hoy.getMonth()+1).toString();
if (mes.length==1) {mes='0'+mes}
return (hoy.getDate()).toString() + '/' +mes + '/' +hoy.getFullYear().toString()

}

function factura2(){
var Tbs;
var totaldsiva=0;
var totalbsiva=0;
var texto='Fecha: '+fecha_actual()+'<br>';
texto+=dist+'<br>';
texto+='Cliente: '+cliente+'<br>';
//texto+='$ Paralelo: '+  impri(document.getElementById("t1").value) +'<br>';
var bcv=parseFloat(document.getElementById("t2").value);
texto+='$ BCV: '+ (bcv).toFixed(2) +'<br>';
texto+="<center>F&aacute;ctura</center>";
var totald=0;
var totalb=0;
Ftexto='Fecha: '+fecha_actual()+'\n';
Ftexto+=dist+'\n';
Ftexto+='Cliente: '+cliente+'\n';
//Ftexto+='$ Paralelo: '+  impri(document.getElementById("t1").value) +'\n';
Ftexto+='$ BCV: '+  (bcv).toFixed(2) +'\n';
Ftexto+="FACTURA\n"
for (var i=0;i<data.length;i++){
factor=parseFloat(document.getElementById("t2").value);
//if (data[i][6]=="t1") {factor=t1;}
//if (data[i][6]=="t2") {factor=t1;}
if (data[i][3]==1) {fm=1.16;} else {fm=1;}

if (data[i][6]=="t1") {
var pu=+(fm*data[i][2]*(1/factor)).toFixed(2);
var pb=+(pu*data[i][1]);
} else {
  if (data[i][6]=="t2") {
   var pu=+(fm*data[i][2]).toFixed(2);
   var pb=+(pu*data[i][1]);
    } else {
   var pb=+(fm*data[i][2]).toFixed(2);
   var pu=+(pb/data[i][1]).toFixed(2);
     
    }
}

var Tdolar=+(data[i][4]*(pu) + data[i][5]*pb);
   if (data[i][6]=="t1") {
   Tbs= data[i][4]*(fm*data[i][2]) + data[i][5]*fm*data[i][2]*data[i][1];
   } else 
        {
    Tbs=Tdolar*factor;
   }

if (Tdolar!=0) { 
  totald+=Tdolar;
  totaldsiva+=parseFloat((Tdolar/fm).toFixed(2));
  totalb+=Tbs;
  totalbsiva+=parseFloat((Tbs/fm).toFixed(2));
  Ftexto+='------------\n';
  texto+='<table width="100%">';
  if (data[i][4]!=0) { 
         texto+='<tr><td colspan="4" style=" font-size:1.5em;background-color:black;color:white;" onclick="cintro('+i+');">'+ data[i][4] +'U '+ data[i][0]+'</td></tr>';
         Ftexto+=data[i][4] +'U '+ data[i][0]+'\n';
//  console.log('pu:'+pu);

  }
  if (data[i][5]!=0) 
    { texto+='<tr><td colspan="4" style="font-size:1.5em;background-color:gray;" onclick="cintro('+i+');">'+ data[i][5] +'B  ' + data[i][0]+' </td></tr>';
        Ftexto+=data[i][5] +'B '+ data[i][0]+'\n';;
    }
if (Tdolar!=0) { 
   texto+='<tr style="align-text:right;font-size:0.5em;"><td style="width:10%;">'+data[i][5]+'</td><td style="width:30%;">'+(pb/fm).toFixed(2)+'$'+'</td><td style="width:30%;">'+(Tdolar/fm).toFixed(2)+' $'+'</td><td style="width:30%;">'+ Tdolar.toFixed(2) +' $&nbsp'+'</tr>';
   Ftexto+='S/IVA: '+(Tdolar/fm).toFixed(2)+' $'+"   C/IVA: "+Tdolar.toFixed(2) + ' $    \n'

}


//if (data[i][3]==1) { 
//  var fr=data[i][5]+ data[i][4]/data[i][1]; 
//  texto+='Retencion: '+  (fr*pb/fiva).toFixed(2)+' $ '+(fr*pb*factor/fiva).toFixed(2)+ ' Bs';
//  Ftexto+='Retencion: '+  (fr*pb/fiva).toFixed(2)+' $ '+(fr*pb*factor/fiva).toFixed(2)+ ' Bs\n';
//}

/*if (data[i][3]==1) { 
  var fr=data[i][5]+ data[i][4]/data[i][1]; 
  texto+='Retencion: '+  (Tdolar/fiva).toFixed(2)+' $ '+(Tbs/fiva).toFixed(2)+ ' Bs';
  Ftexto+='Retencion: '+  (Tdolar/fiva).toFixed(2)+' $ '+(Tbs/fiva).toFixed(2)+ ' Bs\n';
}
*/
}
texto+='</table>';
}


texto+='<HR>';
Ftexto+='============================================\n';
//texto+='<span style="color:yellow; font-size:1em;">Total</span><br>';
texto+='<table width="100%"><tr align="right"><td style="width:15%;"> </td><td style="width:15%;"></td><td style="width:35%;">'+'S/IVA'+'</td><td style="width:35%;">'+'C/IVA'+'</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> Total </td><td style="width:15%;"></td><td style="width:35%;">'+(totaldsiva).toFixed(2)+' $ </td><td style="width:35%;">'+(totald).toFixed(2)+' $&nbsp</td></tr></table>';
texto+='<table width="100%"><tr align="right"><td style="color:#000066; width:15%;"> IVA </td><td style="width:15%;"></td><td style="width:35%;">'+(totald-totaldsiva).toFixed(2)+' $ </td><td style="width:35%;">'+''+'</td></tr></table>';

texto+='<table width="100%"><tr align="right"><td style="width:20%;"> </td><td style="width:20%;"></td><td style="width:30%;">'+(totalbsiva).toFixed(2)+' Bs </td><td style="width:30%;">'+(totalb).toFixed(2)+' Bs&nbsp</td></tr></table>';

Ftexto+='S/IVA: '+(totaldsiva).toFixed(2)+'$  C/IVA: '+(totald).toFixed(2)+' $ \n'
Ftexto+='IVA: '+(totald-totaldsiva).toFixed(2)+'$\n';
Ftexto+='S/IVA: '+(totalbsiva).toFixed(2)+' Bs  '+'C/IVA: '+(totalb).toFixed(2)+' Bs';
console.log(Ftexto);
var textoT='<div style="position: fixed; text-align:right;background-color: gray;width:100%;">';
textoT+='<button style="font-size: 0.9em;" title="Compartir" id="btnc" onclick="compartir();"> C </button> <button  style="font-size: 0.9em;" title="Salir" onclick="quitar();" > x </button></div><br>';
divfactura=document.getElementById("factura")
divfactura.style="position: fixed;top :35px; left: 2px; overflow-y: auto; width: 100% ; height: 80%; background-color: lightgray;color:white; border: 3px solid #73AD21;";
textoT+='<div style="color:black; font-size:0.8em;">'+texto+'</div>';
divfactura.innerHTML=textoT;
divfactura.hidden=false;
}





function compartir(){
const shareData = {
  title: 'Factura',
  text: Ftexto
}
//console.log(shareData);
comparte(shareData);
}

async function comparte(shareData){
  try {
    await navigator.share(shareData)
    console.log('MDN shared successfully');
  } catch(err) {
    console.log( 'Error: ' + err);
  }
}


function anula(){

for (var i=0;i<data.length;i++){
data[i][4]=0;
data[i][5]=0;
}
if (document.getElementById("factura").hidden==false) {factura2();}
}

function quitar(){
var div5 = document.getElementById("factura");
div5.hidden=true;
factflag=true;
}

function refresca2(){
var patron=document.getElementById("search").value.toUpperCase();
var pb;
var pu;
t1=document.getElementById("t1").value;
t2=document.getElementById("t2").value;
localStorage.setItem('p1',t1);
localStorage.setItem('p2',t2);
texto="";
var factor;
var fm;
for (var i=0;i<data.length;i++){
if (data[i][0].toUpperCase().indexOf(patron) !=-1)   {
if (data[i][6]=="t1") {factor=t2;}
if (data[i][6]=="t2") {factor=t2;}
//console.log(i+" "+data[i][0]);
texto+='<p  >'+ data[i][0]+'</p>';
console.log(data[i][0]+' ' +(data[i][2]).toFixed(2));
if (data[i][4]==0) {var vcor='black';} else {var vcor='blue';}
if (data[i][5]==0) {var vcor1='black';} else {var vcor1='blue';}
if (data[i][3]==1) {fm=1.16} else {fm=1}
//var pu=+(fm*data[i][2]/data[i][1]).toFixed(2);
//var pb=+(fm*data[i][2]).toFixed(2);
if (data[i][6]=="t1") {
  var pu=+(fm*data[i][2]*(1/t2)).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
} 
if (data[i][6]=="t2") {
  var pu=+(fm*data[i][2]).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
}

if (data[i][6]=="t3") {
  var pb=+(fm*data[i][2]).toFixed(2);
  var pu=+(pb/data[i][1]).toFixed(2);
}

if (data[i][6]=="t1") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (fm*data[i][2]).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (fm*data[i][2]*data[i][1]).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
} 
if (data[i][6]=="t2") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (pu*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (pb*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
}
  
if (data[i][6]=="t3") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (pu*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (pb*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
}


 if (data[i][3]==1) {
    texto+="<span style='font-size:0.6em;'>Retenci&oacute;n T: "+(fm*data[i][2]/fiva).toFixed(2)+ " $ "+(fm*data[i][2]*factor/fiva).toFixed(2)+" Bs          </span>";
   }
}
}
texto+='<br><br>'
divt.innerHTML=texto;
}
function preciou(i){
var fm
if (data[i][3]==1) {fm=1.16} else {fm=1}
if (data[i][6]=="t1") {
  var pu=+(fm*data[i][2]*(1/t2)).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
} 
if (data[i][6]=="t2") {
  var pu=+(fm*data[i][2]).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
}

if (data[i][6]=="t3") {
  var pb=+(fm*data[i][2]).toFixed(2);
  var pu=+(pb/data[i][1]).toFixed(2);
}
return pu;
}

function preciob(i){
var fm
if (data[i][3]==1) {fm=1.16} else {fm=1}

if (data[i][6]=="t1") {
  var pu=+(fm*data[i][2]*(1/t2)).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
} 
if (data[i][6]=="t2") {
  var pu=+(fm*data[i][2]).toFixed(2);
  var pb=+(pu*data[i][1]).toFixed(2);
}

if (data[i][6]=="t3") {
  var pb=+(fm*data[i][2]).toFixed(2);
  var pu=+(pb/data[i][1]).toFixed(2);
}
return pb;
}
function quitar_intro(){
document.getElementById("introd").style.visibility="hidden";
}

function cambiaU(num){
data[num][4]=document.getElementById("entradaU").value;
intro(num);
}
function cambiaB(num){
data[num][5]=document.getElementById("entradaB").value;
intro(num);
}
function cintro(num){
document.getElementById("factura").hidden=true;
factflag=true;
intro(num);
}

function intro(i){
var totalsivabs;
var totalsivad;
var fm;
var factor=parseFloat(document.getElementById("t2").value);
var BanderaIva;
if (data[i][3]==1) {fm=1.16;BanderaIva="C/IVA";} else {fm=1;BanderaIva="S/IVA";}
var divintro=document.getElementById("introd");
if (data[i][4]==0) {var vcor='red';} else {var vcor='blue';}
if (data[i][5]==0) {var vcor1='red';} else {var vcor1='blue';}
var pu=preciou(i);
var pb=preciob(i);

var texto='<table width="100%" style="background-color:black;color:white;"><tr ><td >'+data[i][0]+' '+BanderaIva+'</td><td style="text-align:left;"><button onclick="quitar_intro();">x</button></td></tr></table>';
if (data[i][6]=="t1") 
{
tex1='U '+(pu).toFixed(2)+' $';
tex2=(fm*data[i][2]).toFixed(2)+ ' Bs';
tex3='B '+(pb).toFixed(2)+' $';
tex4=(fm*data[i][2]*data[i][1]).toFixed(2)+ ' Bs';
} 
if (data[i][6]=="t2") 
{
tex1='U '+(pu).toFixed(2)+' $';
tex2=(pu*factor).toFixed(2)+ ' Bs';
tex3='B '+(pb).toFixed(2)+' $';
tex4=(pb*factor).toFixed(2)+ ' Bs';
}
  
if (data[i][6]=="t3") 
{
tex1='U '+(pu).toFixed(2)+' $';
tex2=(pu*factor).toFixed(2)+ ' Bs';
tex3='B '+(pb).toFixed(2)+' $';
tex4=(pb*factor).toFixed(2)+ ' Bs';
}
if (data[i][4]==0) {var valoru="";} else {var valoru=data[i][4];}
if (data[i][5]==0) {var valorb="";} else {var valorb=data[i][5];}

texto+='<table><tr><td>'+tex1+'</td><td>'+tex2+'</td><td><input id="entradaU" type="number" class="btn2" style="color:'+vcor+';" value="'+valoru+'" onchange="cambiaU('+i+');"></td></tr>';
texto+='<tr><td>'+tex3+'</td><td>'+tex4+'</td><td><input id="entradaB" type="number" class="btn2" style="color:'+vcor+';" value="'+valorb+'" onchange="cambiaB('+i+');"></td></tr></table>';


totalsivad=((pu)*data[i][4]+(pb)*data[i][5])/fm;
totalsivabs=totalsivad*factor;

 texto+='<table width="100%"><tr><td>Total S/IVA</td><td style="text-align:right;">'+(totalsivad).toFixed(2)+'</td><td style="color:blue:">$</td><td style="text-align:right;">'+(totalsivabs).toFixed(2)+'</td><td>Bs</td></tr>';
 texto+='<tr><td>Total C/IVA</td><td style="text-align:right;">'+(totalsivad*fm).toFixed(2)+'</td><td>$</td><td style="text-align:right;">'+(totalsivabs*fm).toFixed(2)+'</td><td>Bs</td></tr>';
 texto+='<tr><td>Diferencia IVA</td><td style="text-align:right;">'+(totalsivad*(fm-1)).toFixed(2)+'</td><td>$</td><td style="text-align:right;">'+(totalsivabs*(fm-1)).toFixed(2)+'</td><td>Bs</td></tr>';
 
texto+='</table>';
 if (data[i][3]==1) {
    texto+="<span style='font-size:0.6em;'>Retenci&oacute;n T: "+(fm*data[i][2]/fiva).toFixed(2)+ " $ "+(fm*data[i][2]*factor/fiva).toFixed(2)+" Bs          </span>";
   }

//texto+='U:'+pu+'<br>';
//texto+='B:'+pb+'<br>';


divintro.innerHTML=texto;
divintro.style.visibility = "visible";
console.log('num '+i);
console.log(divintro);
}

function refresca(){
//var patron=document.getElementById("search").value.toUpperCase();
var pb;
var pu;
t1=document.getElementById("t1").value;
t2=document.getElementById("t2").value;
localStorage.setItem('p1',t1);
localStorage.setItem('p2',t2);
texto="";
var factor;
var fm;
var cat_comp='&';
for (var i=1;i<Stack_cat.length;i++) {
 cat_comp+=Stack_cat[i]+'&';
}
var hay=false;
for (var i=0;i<data.length;i++){
//if (data[i][0].toUpperCase().indexOf(patron) !=-1) 
//console.log(i + " " +data[i][7]);  
//if (data[i][7].indexOf(cat_comp) !=-1) 

if ((data[i][7]==cat_comp) && (data[i][8]==1))  
{
console.log(data[i][8]);
hay=true;
if (data[i][6]=="t1") {factor=t2;}
if (data[i][6]=="t2") {factor=t2;}
//console.log(i+" "+data[i][0]);
texto+='<button class="bot4" onclick="intro('+i+');">'+ data[i][0]+'</button><br>';
console.log(data[i][0]+' ' +(data[i][2]).toFixed(2));
/*if (data[i][4]==0) {var vcor='black';} else {var vcor='blue';}
if (data[i][5]==0) {var vcor1='black';} else {var vcor1='blue';}
if (data[i][3]==1) {fm=1.16} else {fm=1}
//var pu=+(fm*data[i][2]/data[i][1]).toFixed(2);
//var pb=+(fm*data[i][2]).toFixed(2);


if (data[i][6]=="t1") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (fm*data[i][2]).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (fm*data[i][2]*data[i][1]).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
} 
if (data[i][6]=="t2") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (pu*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (pb*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
}
  
if (data[i][6]=="t3") 
{
texto+='<table><tr><td> U '+(pu).toFixed(2)+' $' +'</td><td>'+ (pu*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor+';"'+'onclick="actU('+i+');">'+data[i][4]+'</button></td></tr>';
texto+='<tr><td> B '+(pb).toFixed(2)+' $'+'</td><td>'+ (pb*factor).toFixed(2)+ ' Bs <button class="btn2" style="color:'+vcor1+';"'+'onclick="actT('+i+');">'+data[i][5]+'</button></td></tr></table>';
}


 if (data[i][3]==1) {
    texto+="<span style='font-size:0.6em;'>Retenci&oacute;n T: "+(fm*data[i][2]/fiva).toFixed(2)+ " $ "+(fm*data[i][2]*factor/fiva).toFixed(2)+" Bs          </span>";
   }
*/
}

}
texto+='<br><br>'
divt.innerHTML=texto;
if (!hay) {
   document.getElementById("introd").style.visibility = "hidden";}
   else {
   document.getElementById("cat").style.visibility = "hidden";
}
}

function impri(A){
var At=A.toString();
var p=At.indexOf('.');
var num=At.substring(0,p);
var dec=At.substring(p+1,At.length);
//console.log(p+" "+num+" "+dec);
var B="";
var j=0;
var indfin=num.length
var porc=[];
while (indfin>0) {
porc[j]=num.substring(indfin-3,indfin);
indfin=indfin-3;
j=j+1;
}

for(var j=porc.length-1;j>0;j--)
{
B=B+porc[j]+".";
}
B=B+porc[0]+","+dec
//console.log(B);
return B;
}
impri(12356.3478);

</script>
<script>

// Registra el service worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('sw.js').then(function(registration) {
      // Si es exitoso
      console.log('SW registrado correctamente');
    }, function(err) {
      // Si falla
      console.log('SW fallo', err);
    });
  });
}
Act_data();
function Act_data(){
var myHeaders = new Headers();

var myInit = { mode: 'cors' };

//var nombrepag="https://monitordolarvenezuela.com/monitor-dolar-hoy";
var nombrepag="https://bdeabreu66.github.io/factura/precios.txt";


fetch(nombrepag,myInit)
        .then(ajaxPositive)
        .catch(showError);

function ajaxPositive(response) {
      console.log('response.ok: ', response.ok);
      if(response.ok) {
        response.text().then(showResult);
      } else {
        showError('status code: ' + response.status);
      }
    }
 function showResult(txt) {
        //console.log('muestro respuesta: ', txt);
        localStorage.setItem('data',txt);
        data=eval(txt);
       
        set_cat();
        muestra_cat();
        refresca();
         recupera_pedido();
  }

function showError(err) { 
      console.log('muestor error', err);
    }
}

function Actualiza_dolar(){
var nomb="https://s3.amazonaws.com/dolartoday/data.json"
//var myHeaders = new Headers();
var myInit = { mode: 'cors' };

fetch(nomb,myInit)
        .then(ajaxPositiveD)
        .catch(showErrorD);

function ajaxPositiveD(response) {
      console.log('response.ok: ', response.ok);
      if(response.ok) {
        response.json().then(showResultD);
      } else {
        showErrorD('status code: ' + response.status);
      }
    }
 function showResultD(txt) {
       console.log('muestro respuesta: ', txt.USD.sicad2);
       document.getElementById("t1").value = txt.USD.promedio;
       document.getElementById("t2").value = txt.USD.sicad2;
       refresca();
  }

function showErrorD(err) { 
      console.log('muestor error', err);
    }
}

Fecha_precios();

function Fecha_precios(){
var nomb="https://bdeabreu66.github.io/factura/fecha.txt";


//var myHeaders = new Headers();
var myInit = { mode: 'cors' };

fetch(nomb,myInit)
        .then(ajaxPositiveD)
        .catch(showErrorD);

function ajaxPositiveD(response) {
      console.log('response.ok: ', response.ok);
      if(response.ok) {
        response.json().then(showResultD);
      } else {
        showErrorD('status code: ' + response.status);
      }
    }
 function showResultD(txt) {
       console.log('fecha: '+ txt.dia+txt.mes+txt.ano);
      // document.getElementById("t1").value = txt.USD.promedio;
     //    document.getElementById("t2").value = txt.USD.sicad2;
      var fecha='('+txt.dia+'/'+txt.mes+'/'+txt.ano+')';
      document.getElementById("fecha_p").innerText=fecha;
      localStorage.setItem('FECHA_P',fecha);
  //  refresca();
  }

function showErrorD(err) { 
      console.log('muestor error', err);
    }

}


</script>
</BODY>
</html>